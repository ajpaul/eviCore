/* module-payments@v2.6.9 build with â™¥ by bb-lp-cli@v1.9.12 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("core"),require("ui"),require("module-enrollment")):"function"==typeof define&&define.amd?define(["base","core","ui","module-enrollment"],t):"object"==typeof exports?exports["module-payments"]=t(require("base"),require("core"),require("ui"),require("module-enrollment")):e["module-payments"]=t(e.base,e.core,e.ui,e["module-enrollment"])}(this,function(e,t,n,a){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,exports,t){t(2),e.exports=t(6)},,function(e,exports,t){var n=t(3);"string"==typeof n&&(n=[[e.id,n,""]]);t(5)(n,{});n.locals&&(e.exports=n.locals)},function(e,exports,t){exports=e.exports=t(4)(),exports.push([e.id,".lp-labeled-input{border-radius:3px}.lp-otp-check .otp-content{padding:1em}.lp-otp-check .otp-nav{position:absolute;width:100%;left:0;bottom:0;padding:1em}.lp-otp-check .channel-selector{margin:3em 0}.lp-otp-check .channel-selector .cell{margin-bottom:1em}.lp-otp-check .channel-selector .custom-radio{margin-bottom:2em}.lp-otp-check .channel-selector .custom-radio .radio-label{display:inline-block;position:relative;padding-left:.7em;transform:translateY(-20%)}.lp-otp-check .channel-selector .custom-radio .radio-label .radio-label-main{color:#000}.lp-otp-check .channel-selector .custom-radio span{vertical-align:middle}.lp-otp-check.is-desktop .close-button{margin:5px;cursor:pointer}",""])},function(e,exports){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var a={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(a[i]=!0)}for(r=0;r<t.length;r++){var o=t[r];"number"==typeof o[0]&&a[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),e.push(o))}},e}},function(e,exports,t){function n(e,t){for(var n=0;n<e.length;n++){var a=e[n],r=u[a.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](a.parts[i]);for(;i<a.parts.length;i++)r.parts.push(o(a.parts[i],t))}else{for(var s=[],i=0;i<a.parts.length;i++)s.push(o(a.parts[i],t));u[a.id]={id:a.id,refs:1,parts:s}}}}function a(e){for(var t=[],n={},a=0;a<e.length;a++){var r=e[a],i=r[0],o=r[1],s=r[2],l=r[3],c={css:o,media:s,sourceMap:l};n[i]?n[i].parts.push(c):t.push(n[i]={id:i,parts:[c]})}return t}function r(){var e=document.createElement("style"),t=f();return e.type="text/css",t.appendChild(e),e}function i(){var e=document.createElement("link"),t=f();return e.rel="stylesheet",t.appendChild(e),e}function o(e,t){var n,a,o;if(t.singleton){var u=h++;n=m||(m=r()),a=s.bind(null,n,u,!1),o=s.bind(null,n,u,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=i(),a=c.bind(null,n),o=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=r(),a=l.bind(null,n),o=function(){n.parentNode.removeChild(n)});return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else o()}}function s(e,t,n,a){var r=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=v(t,r);else{var i=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function l(e,t){var n=t.css,a=t.media;t.sourceMap;if(a&&e.setAttribute("media",a),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function c(e,t){var n=t.css,a=(t.media,t.sourceMap);a&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var r=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var u={},d=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},p=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),f=d(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,h=0;e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=p());var r=a(e);return n(r,t),function(e){for(var i=[],o=0;o<r.length;o++){var s=r[o],l=u[s.id];l.refs--,i.push(l)}if(e){var c=a(e);n(c,t)}for(var o=0;o<i.length;o++){var l=i[o];if(0===l.refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete u[l.id]}}}};var v=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){e.name="module-payments";var n=t(8),a=[t(9).name,t(10).name,t(14).name,t(16).name,t(21).name,t(24).name,t(17).name];e.exports=n.createModule(e.name,a).constant(t(41)).provider(t(42)).provider(t(43)).service(t(44))}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(7)(e))},function(e,exports){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(t,exports){t.exports=e},function(e,exports){e.exports=t},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){e.name="scheduled-transfer";var n=t(8),a=t(9),r=t(11),i=[a.name,r.name];e.exports=n.createModule(e.name,i).directive(t(12))}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(7)(e))},function(e,exports){e.exports=n},function(e,exports,t){var n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};n=function(require,exports,e){"use strict";var n=t(13);exports.lpScheduledTransfer=function(e){function t(e,t,r,i){var o,s=i[0],l=i[1],c=function(){return e.scheduledTransfer.frequency===e.frequenciesEnum.WEEKLY||e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY||e.scheduledTransfer.frequency===e.frequenciesEnum.YEARLY},u=function(){var t=!1;if(e.scheduledTransfer.intervals.length>0&&e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY)for(var n=28;n<31;n++)e.dates[n].active&&(t=!0);e.dateWarning=t},d=function(){var t=!0;t=e.scheduledTransfer.intervals.length>0,t=!e.customOrder||t,t=!e.isScheduledTransfer||t,s.$setValidity("intervalsRequired",t)},p=function(){var t,n;for(e.scheduledTransfer.intervals=[],t=0,n=e.days.length;t<n;t++)e.days[t].active=!1;for(t=0,n=e.dates.length;t<n;t++)e.dates[t].active=!1;for(t=0,n=e.months.length;t<n;t++)e.months[t].active=!1},f=function(){e.todaysDate=new Date,e.minEndDate=new Date,e.frequenciesEnum={START_OF_THE_MONTH:"START_OF_THE_MONTH",END_OF_THE_MONTH:"END_OF_THE_MONTH",LAST_FRIDAY_OF_THE_MONTH:"LAST_FRIDAY_OF_THE_MONTH",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"},o=new n({frequencies:e.frequenciesEnum}),e.frequencies||(e.frequencies=[{id:e.frequenciesEnum.START_OF_THE_MONTH,value:"First of the month",group:"apreset"},{id:e.frequenciesEnum.END_OF_THE_MONTH,value:"End of the month",group:"apreset"},{id:e.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH,value:"Last Friday of the month",group:"apreset"},{id:e.frequenciesEnum.WEEKLY,value:"Weekly",group:"bcustom"},{id:e.frequenciesEnum.MONTHLY,value:"Monthly",group:"bcustom"},{id:e.frequenciesEnum.YEARLY,value:"Yearly",group:"bcustom"}]),e.days=[{id:1,value:"M",label:"Monday",active:!1},{id:2,value:"T",label:"Tuesday",active:!1},{id:3,value:"W",label:"Wednesday",active:!1},{id:4,value:"T",label:"Thursday",active:!1},{id:5,value:"F",label:"Friday",active:!1},{id:6,value:"S",label:"Saturday",active:!1},{id:7,value:"S",label:"Sunday",active:!1}],e.months=[{id:1,value:"Jan",label:"January",active:!1},{id:2,value:"Feb",label:"February",active:!1},{id:3,value:"Mar",label:"March",active:!1},{id:4,value:"Apr",label:"April",active:!1},{id:5,value:"May",label:"May",active:!1},{id:6,value:"Jun",label:"June",active:!1},{id:7,value:"Jul",label:"July",active:!1},{id:8,value:"Aug",label:"August",active:!1},{id:9,value:"Sep",label:"September",active:!1},{id:10,value:"Oct",label:"October",active:!1},{id:11,value:"Nov",label:"November",active:!1},{id:12,value:"Dec",label:"December",active:!1}],e.dates=[];for(var t=1;t<32;t++)e.dates.push({id:t,value:t,label:t,active:!1});e.endOptions||(e.endOptions=[{id:"after",value:"After"},{id:"onDate",value:"On date"}]),e.scheduledTransfer.endOn=e.endOptions[0].id,e.customOrder=!1,e.dateWarning=!1,e.calendar={startCalendarOpen:!1,endCalendarOpen:!1},e.endDateOptions={datepickerMode:"year","show-weeks":!1},e.startDateOptions={"show-weeks":!1},e.timesEndDate=e.scheduledTransfer.endDate,e.setEndDate()};s.$name="scheduledTransfer",l.$addControl(s),s.$formatters.push(function(t){if(t.intervals.length>0){var n,a;if(t.frequency===e.frequenciesEnum.WEEKLY){for(n=0;n<t.intervals.length;n++)for(a=0;a<e.days.length;a++)if(t.intervals[n]===e.days[a].id){e.days[a].active=!0;break}}else if(t.frequency===e.frequenciesEnum.MONTHLY){for(n=0;n<t.intervals.length;n++)for(a=0;a<e.dates.length;a++)if(t.intervals[n]===e.dates[a].id){e.dates[a].active=!0;break}}else if(t.frequency===e.frequenciesEnum.YEARLY)for(n=0;n<t.intervals.length;n++)for(a=0;a<e.months.length;a++)if(t.intervals[n]===e.months[a].id){e.months[a].active=!0;break}}e.scheduledTransfer.frequency=""===t.frequency?e.frequencies[0].id:t.frequency,c()?e.customOrder=!0:e.customOrder=!1,u(),e.setTransferPeriodDates()}),e.frequencyChanged=function(){p(),e.setTransferPeriodDates(),c()?(e.customOrder=!0,d(),e.scheduledTransfer.customOrder=!0):(e.customOrder=!1,s.$setValidity("intervalsRequired",!0),e.scheduledTransfer.customOrder=!1),u()},e.toggleInterval=function(t){var n,a;if(e.scheduledTransfer.frequency===e.frequenciesEnum.WEEKLY?n=e.days:e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY?n=e.dates:e.scheduledTransfer.frequency===e.frequenciesEnum.YEARLY&&(n=e.months),a=n[t],a.active){var r=e.scheduledTransfer.intervals.indexOf(a.id);e.scheduledTransfer.intervals.splice(r,1)}else e.scheduledTransfer.intervals.push(a.id);a.active=!a.active,d(),u(),e.setEndDate()},e.openStartCalendar=function(t){"click"!==t.type&&32!==t.which&&13!==t.which||(t.preventDefault(),t.stopPropagation(),e.calendar.endCalendarOpen=!1,e.calendar.startCalendarOpen=!e.calendar.startCalendarOpen)},e.openEndCalendar=function(t){"click"!==t.type&&32!==t.which&&13!==t.which||(t.preventDefault(),t.stopPropagation(),e.calendar.startCalendarOpen=!1,e.calendar.endCalendarOpen=!e.calendar.endCalendarOpen)},e.setTransferPeriodDates=function(){"object"!==a(e.scheduledTransfer.startDate)&&(c()?e.scheduledTransfer.startDate=new Date(e.todaysDate.getTime()):e.scheduledTransfer.frequency===e.frequenciesEnum.END_OF_THE_MONTH?e.scheduledTransfer.startDate=o.getLastDayOfMonth():e.scheduledTransfer.frequency===e.frequenciesEnum.START_OF_THE_MONTH?e.scheduledTransfer.startDate=o.getFirstDayOfMonth():e.scheduledTransfer.frequency===e.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(e.scheduledTransfer.startDate=o.getLastFridayOfMonth())),e.setEndDate()},e.setEndDate=function(){var t;if(e.scheduledTransfer.startDate){var n=new Date(e.scheduledTransfer.startDate.getTime());c()?(t=e.scheduledTransfer.timesToRepeat*e.scheduledTransfer.every,e.scheduledTransfer.frequency===e.frequenciesEnum.WEEKLY?n=o.addWeeksToDate(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY?n=o.addMonthsToDate(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.YEARLY&&(n=o.addYearsToDate(n,t))):(t=e.scheduledTransfer.timesToRepeat,t=e.scheduledTransfer.timesToRepeat,e.scheduledTransfer.frequency===e.frequenciesEnum.END_OF_THE_MONTH?n=o.getLastDayOfMonthPlusTime(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.START_OF_THE_MONTH?n=o.getFirstDayOfMonthPlusTime(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(n=o.getLastFridayOfMonthPlusTime(n,t))),e.scheduledTransfer.endDate=n,e.minEndDate=o.calculateMinimumEndDate(e.scheduledTransfer.frequency,e.scheduledTransfer.every,new Date(e.scheduledTransfer.startDate.getTime())),e.timesEndDate=new Date(e.scheduledTransfer.endDate.getTime()).toString("d-MMM-yyyy")}},e.$watch("isScheduledTransfer",function(e){d()}),e.$on("reset",function(){e.scheduledTransfer.frequency=e.frequencies[0].id,e.customOrder=!1,e.scheduledTransfer.customOrder=!1}),f()}return e.put("scheduled-transfer.html",'<div class="lp-scheduled-transfer">    <div class="lp-st-frequency lp-st-section clearfix">        <div class="pull-left lp-st-caption">Frequency</div>        <div class="pull-left lp-st-control">            <div class="lp-st-frequency-dropdown" aria-label="frequency" dropdown-select="dropdown-select" ng-change="frequencyChanged()" ng-model="scheduledTransfer.frequency" options="val.id as val.value group by val.group for val in frequencies"></div>        </div>    </div>    <div class="lp-st-every lp-st-section clearfix">        <div class="pull-left lp-st-caption" ng-if="customOrder">Every</div>        <div class="pull-left lp-st-control clearfix" ng-if="scheduledTransfer.frequency === frequenciesEnum.WEEKLY">            <input type="number" lp-number-input="lp-number-input" lp-max-length="1" min="1" step="0" non-zero="non-zero" class="lp-st-every-input pull-left" name="repeatEvery" required="required" tabindex="0" aria-required="true" aria-label="Repeat weekly transfer every" maxlength="2" ng-model="scheduledTransfer.every" ng-change="setEndDate()" /><span>week(s) on:</span>        </div>        <div class="pull-left lp-st-control clearfix" ng-if="scheduledTransfer.frequency === frequenciesEnum.MONTHLY">            <input type="number" lp-number-input="lp-number-input" lp-max-length="1" min="1" step="0" non-zero="non-zero" class="lp-st-every-input pull-left" name="repeatEvery" required="required" tabindex="0" aria-required="true" aria-label="Repeat monthly transfer every" maxlength="2" ng-model="scheduledTransfer.every" ng-change="setEndDate()" /><span>month(s) on:</span>        </div>        <div class="pull-left lp-st-control clearfix" ng-if="scheduledTransfer.frequency === frequenciesEnum.YEARLY">            <input type="number" lp-number-input="lp-number-input" lp-max-length="1" min="1" step="0" non-zero="non-zero" class="lp-st-every-input pull-left" name="repeatEvery" required="required" tabindex="0" aria-required="true"  aria-label="Repeat yearly transfer every" maxlength="2" ng-model="scheduledTransfer.every" ng-change="setEndDate()" /><span>year(s):</span>        </div>    </div>    <div class="lp-st-interval lp-st-section clearfix" ng-if="customOrder">        <div class="lp-st-interval-menu weekly btn-group" ng-if="scheduledTransfer.frequency === frequenciesEnum.WEEKLY">            <button type="button" interval-button="interval-button" aria-label="{{day.label}}" ng-class="{\'active\': day.active}" class="btn btn-default" tabindex="0"  ng-click="toggleInterval($index)" ng-repeat="day in days" ng-model="day">{{day.value}}</button>        </div>        <div class="lp-st-interval-menu monthly btn-group" ng-if="scheduledTransfer.frequency === frequenciesEnum.MONTHLY">            <button type="button" interval-button="interval-button" aria-label="{{date.label}}" ng-class="{\'active\': date.active}" class="btn btn-default" tabindex="0"  ng-click="toggleInterval($index)" ng-repeat="date in dates" ng-model="date">{{date.value}}</button>        </div>        <div class="lp-st-interval-menu yearly btn-group" ng-if="scheduledTransfer.frequency === frequenciesEnum.YEARLY">            <button type="button" interval-button="interval-button" aria-label="{{month.label}}" ng-class="{\'active\': month.active}" class="btn btn-default" tabindex="0" ng-click="toggleInterval($index)" ng-repeat="month in months" ng-model="month">{{month.value}}</button>        </div>    </div>    <div class="lp-st-start-date lp-st-section clearfix">        <div class="pull-left lp-st-caption">Start</div>        <div class="pull-left lp-st-control calendar">            <input ng-click="openStartCalendar($event)" aria-label="start date" type="text" ng-required="isScheduledTransfer === true" name="startDate" ng-model="scheduledTransfer.startDate" datepicker-popup="d-MMM-yyyy" readonly="readonly" is-open="calendar.startCalendarOpen" datepicker-options="startDateOptions" min-date="todaysDate" class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-change="setEndDate()" ng-keypress="openStartCalendar($event)" />            <span ng-click="openStartCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>        </div>    </div>    <div class="lp-st-end-on lp-st-section clearfix">        <div class="pull-left lp-st-caption">End</div>        <div class="pull-left lp-st-control">            <div class="lp-st-end-on-dropdown" aria-label="end on" dropdown-select="dropdown-select" ng-change="endOnChanged()" ng-model="scheduledTransfer.endOn" options="val.id as val.value for val in endOptions"></div>        </div>    </div>    <div class="lp-st-end-after lp-st-section clearfix" ng-if="scheduledTransfer.endOn === \'after\'">        <div class="pull-left lp-st-caption">Repeat</div>        <div class="pull-left lp-st-control">            <input type="number" lp-number-input="lp-number-input" lp-max-length="2" min="1" step="0" non-zero="non-zero" class="form-control" aria-label="times to repeat" name="timesToRepeat" aria-required="true" required="required" tabindex="0" ng-model="scheduledTransfer.timesToRepeat" ng-change="setEndDate()"  />        </div>    </div>    <p class="text-muted" ng-if="scheduledTransfer.endOn === \'after\' && timesEndDate.length > 0" style="margin-left: 5px + ">Completion date: {{timesEndDate}}</p>    <div class="lp-st-end-date lp-st-section clearfix" ng-if="scheduledTransfer.endOn === \'onDate\'">        <div class="pull-left lp-st-caption">End date</div>        <div class="pull-left lp-st-control calendar">            <input ng-click="openEndCalendar($event)" aria-label="end date" type="text" ng-required="isScheduledTransfer === true" name="endDate" ng-model="scheduledTransfer.endDate" readonly="readonly" datepicker-popup="d-MMM-yyyy" is-open="calendar.endCalendarOpen" datepicker-options="endDateOptions" min-date="minEndDate" class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-keypress="openEndCalendar($event)" />            <span ng-click="openEndCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>        </div>    </div>    <p ng-if="dateWarning">Transfer will be put through on the last day of the month if the month is not long enough</p></div>'),{restrict:"AE",replace:!0,require:["ngModel","^form"],template:e.get("scheduled-transfer.html"),scope:{scheduledTransfer:"=ngModel",isScheduledTransfer:"=lpIsScheduledTransfer",frequencies:"=?frequencies",endOptions:"=?endOptions"},link:t}},exports.lpScheduledTransfer.$inject=["$templateCache"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=t(8),a=n.inject("lpCoreUtils",t(9).name),r=e.exports=function(e){var t=this;t.frequencies=e.frequencies};r.prototype.addWeeksToDate=function(e,t){return a.date(e).add(t,"weeks").toDate()},r.prototype.addMonthsToDate=function(e,t){return a.date(e).add(t,"months").toDate()},r.prototype.addYearsToDate=function(e,t){return a.date(e).add(t,"years").toDate()},r.prototype.getLastDayOfMonth=function(){return a.date().endOf("month").toDate()},r.prototype.getFirstDayOfMonth=function(){var e=a.date();return 1!==e.date()&&e.add(1,"month").startOf("month"),e.toDate()},r.prototype.getLastFridayOfMonth=function(){var e=a.date().endOf("month");return e.day()>=5?e.subtract(e.day()-5,"days"):e.subtract(e.day()+2,"days"),e.toDate()},r.prototype.getLastDayOfMonthPlusTime=function(e,t){return a.date(e).add(t-1,"month").endOf("month").toDate()},r.prototype.getFirstDayOfMonthPlusTime=function(e,t){var n=a.date(e).clone();return 0===n.day()?(n.add(t-1,"months").startOf("month"),e=n.isBefore(e)?n.add(1,"months"):n):e=a.date(e).add(t,"months").startOf("month"),e.toDate()},r.prototype.getLastFridayOfMonthPlusTime=function(e,t){var n=a.date(e).clone(),r=function(e){return e.subtract(1,"week").endOf("week").subtract(1,"days")};return 5!==n.endOf("month").day()?(r(n),n.isBefore(e)?n.add(t,"months"):n.add(t-1,"months"),5!==n.endOf("month").day()&&r(n)):(n.add(t-1,"months").endOf("month"),5!==n.day()&&r(n)),n.toDate()},r.prototype.calculateMinimumEndDate=function(e,t,n){switch(e){case this.frequencies.WEEKLY:n=a.date(n).add(1*t,"weeks").toDate();break;case this.frequencies.MONTHLY:n=a.date(n).add(1*t,"months").toDate();break;case this.frequencies.YEARLY:n=a.date(n).add(1*t,"years").toDate();break;case this.frequencies.LAST_FRIDAY_OF_THE_MONTH:n=this.getLastFridayOfMonthPlusTime(n,1);break;case this.frequencies.START_OF_THE_MONTH:n=this.getFirstDayOfMonthPlusTime(n,1);break;case this.frequencies.END_OF_THE_MONTH:n=this.getLastDayOfMonthPlusTime(n,1)}return n}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){e.name="lp-amount-input";var n=t(8),a=t(9),r=t(11),i=[a.name,r.name];e.exports=n.createModule(e.name,i).directive(t(15))}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(7)(e))},function(e,exports,t){var n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};n=function(require,exports,e){"use strict";var t={decimals:2,hideGroupSep:!1,allowNegative:!1,currencySymbol:""};exports.lpAmountInput=function(e,n,r){function i(i,s,l,c){function u(e){var t=e>0?h+new Array(e+1).join("0"):"",n=y+" #"+v+"##0"+t;return new o(n,{reverse:!0})}function d(t){if(!t)return"";var n=m.allowNegative&&t<0?"-":"",a=e.prepareNumberToFormatter(t,m.decimals);return n+f.apply(a)}function p(e){if(!e)return"";var t,n=e.replace(/[^\d]+/g,"");if(n=n.replace(/^[0]+([1-9])/,"$1"),t=f.apply(n),m.allowNegative){var a="-"===e[0],r="-"===e.slice(-1);r^a&&n&&(n*=-1,t="-"+t)}return e!==t&&(c.$setViewValue(t),c.$render()),t=t?parseInt(t.replace(/[^\d\-]+/g,""),10)/Math.pow(10,m.decimals):null}l.lpAmountInput&&(l.lpAmountInput=r(l.lpAmountInput)(i));var f,m=e.defaults(l.lpAmountInput||{},t),h=n.NUMBER_FORMATS.DECIMAL_SEP,v=n.NUMBER_FORMATS.GROUP_SEP,y=m.currencySymbol||n.NUMBER_FORMATS.CURRENCY_SYM;m.hideGroupSep&&(v=""),f=u(m.decimals),l.$observe("lpAmountInput",function(e){e=r(e)(i),null!==e&&"object"===("undefined"==typeof e?"undefined":a(e))&&(""!==e.currencySymbol&&(y=e.currencySymbol),f=u(m.decimals),p(c.$viewValue))}),c.$formatters.push(d),c.$parsers.push(p)}var o=e.StringMask;return{require:"ngModel",restrict:"A",link:i}},exports.lpAmountInput.$inject=["lpUIUtils","$locale","$parse"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){e.name="otp-check";var n=t(8),a=[t(17).name];e.exports=n.createModule(e.name,a).directive(t(18))}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(7)(e))},function(e,exports){e.exports=a},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=t(19),a=t(20).fields;exports.otpCheck=function(e,t,r,i){function o(n,o,s,l){var c=n.otpEventNamespace||"";n.otp={},n.otp.input=i.clone(a.verifyOtp),n.otp.input.name=n.otpInputName||n.otp.input.name,n.otp.input.api=function(){return{verifyOtp:function(e){return n.otpApi(e)}}},n.mask=r.maskStringMaker,n.otp.showChannelSelector=!0,n.otp.showOtpVerification=!1,n.selectChannel=function(e){n.channelSelected=e},n.cancel=function(){n.back(),n.otp.input.value=null,n.channelSelected=!1,n.otpNext=!1,t.publish("lp-labeled-input:reset:by:name",n.otpInputName)},n.back=function(){n.otp.showChannelSelector=!0,n.otp.showOtpVerification=!1},n.select=function(){n.loading=!0,t.publish(c+".lp-otp-check-select-channel",n.channelSelected)},t.subscribe(c+".lp-otp-check-channel-response-success",function(){n.loading=!1,n.otp.showChannelSelector=!1,n.otp.showOtpVerification=!0,n.codeSent="Sent",e(function(){n.codeSent=!1},500)}),t.subscribe(c+".lp-otp-check-channel-response-error",function(t){n.loading=!1,n.serverError=t.statusText||"Server error!",e(function(){n.serverError=!1},5e3)}),n.serverResponseFails=!1,n.serverValidationFails=!1,t.subscribe("lp-enrollment:validation:external",function(a){a.name===n.otpInputName&&(a.serverError?(n.verifyLoading=!1,n.serverResponseFails="Server error for ["+a.name+"]"):n.serverResponseFails=!1,a.validationError?(n.verifyLoading=!1,n.serverValidationFails=a.validationError):n.serverValidationFails=!1,n.serverResponseFails||n.serverValidationFails||e(function(){n.cancel(),t.publish(c+".lp-otp-check-success")},500))}),n.verify=function(){n.verifyLoading=!0,t.publish("lp-enrollment:verify:by",n.otpInputName)}}function s(e,t){return o}return{scope:{otpNext:"=",otpApi:"=",otpInputName:"@",otpEventNamespace:"@"},template:n,compile:s,restrict:"AE",link:o}},exports.otpCheck.$inject=["$timeout","lpCoreBus","lpEnrollmentUtil","lpCoreUtils"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";e.exports='<!-- DESKTOP --><div class="lp-otp-check otp-check is-desktop">   <div ng-show="otp.showChannelSelector">       <div class="otp-content">           <h3 lp-i18n="Verification required"></h3>           <div class="text-muted" lp-i18n="Same sensitive payments require you to provide a verification code. This does not affect your registered devices."></div>           <h5 ng-show="serverError" class="text-red" lp-i18n="{{ serverError }}"></h5>           <h5 ng-hide="serverError" class="text-success">&nbsp;</h5>           <h5 lp-i18n="Where do you want to receive your verification code?"></h5>           <div class="channel-selector row">               <div class="cell col-xs-12 col-sm-12 col-md-12 col-lg-12">                   <div lp-custom-radio="" class="custom-radio custom-radio-lg" ng-model="channelSelected" value="phone" name="numbers">                       <div class="radio-label">                           <div class="radio-label-main" lp-i18n="Use my mobile phone"></div>                           <div class="radio-label-small" lp-i18n="{{ mask(\'phone\')(otpNext.phone.phoneNumber) }}"></div>                       </div>                   </div>                   <div lp-custom-radio="" class="custom-radio custom-radio-lg" ng-model="channelSelected" value="email" name="numbers">                       <div class="radio-label">                           <div class="radio-label-main" lp-i18n="Use my email"></div>                           <div class="radio-label-small" lp-i18n="{{ mask(\'email\')(otpNext.email.emailAddress) }}"></div>                       </div>                   </div>               </div>           </div>       </div>         <div class="otp-nav text-right">           <button ng-click="cancel()" ng-disabled="loading" class="btn btn-link" lp-i18n="Cancel"></button>           <button ng-click="select()" ng-disabled="!channelSelected || loading" class="btn btn-primary" lp-i18n="Send my code"></button>           <i ng-show="loading" class="loading-button"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span></i>       </div>   </div>   <!-- Step 2: verify code -->   <div ng-show="otp.showOtpVerification">       <div class="otp-content">           <h4 lp-i18n="Enter authentication code:"></h4>           <div class="row">               <div class="col-xs-12 col-sm-8 col-md-6 col-lg-5">                   <div lp-labeled-input-field="lp-labeled-input-field"                       external-verification="{{ otp.input.externalVerification }}"                       input-type="{{ otp.input.type }}"                       api="otp.input.api()"                       description="templates/otp.html"                       button-inside="otp.input.buttonInside"                       input-value="otp.input.value"                       is-required="{{ otp.input.required }}"                       input-pattern="{{ otp.input.pattern }}"                       pattern-error-msg="{{ otp.input.errorMsg }}"                       field-name="{{ otp.input.name }}"                       placeholder-text="{{ otp.input.placeholder }}"></div>               </div>           </div>           <h5 ng-show="serverResponseFails" class="text-red" lp-i18n="Server response failed!"></h5>           <h5 ng-show="serverValidationFails" class="text-red" lp-i18n="{{serverValidationFails}}"></h5>           <br><button ng-click="select()" ng-disabled="!channelSelected || loading" class="btn btn-link text-right" lp-i18n="Re-send code"></button>           <span ng-show="codeSent" class="text-success" lp-i18n="{{ codeSent }}"></span>           <i ng-show="loading" class="loading-button"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span></i>           <span ng-show="serverError" class="text-red text-center" lp-i18n="{{ serverError }}"></span>       </div>       <div class="otp-nav text-right">           <button ng-click="back()" ng-disabled="loading" class="btn btn-link" lp-i18n="Back"></button>           <button ng-click="verify()" class="btn btn-primary verify-button" ng-disabled="!otp.input.value || loading" lp-i18n="Verify"></button>       </div>   </div></div>'}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.fields={verifyOtp:{name:"otpCode",required:!0,externalVerification:"verifyOtp",buttonInside:!0,type:"text",pattern:"/^[0-9]{6}$/",errorMsg:"Wrong format: should be at least 6 digits",placeholder:"Enter your code",value:null}}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){e.name="module-payments-deprecated";var n=t(8),a=[];e.exports=n.createModule(e.name,a).factory(t(22)).directive(t(23))}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(7)(e))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.ScheduledDateCalculator=function(e){var t=function(e){var t=this;t.frequencies=e.frequencies};return t.prototype.addWeeksToDate=function(t,n){return e.date(t).add(n,"weeks").toDate()},t.prototype.addMonthsToDate=function(t,n){return e.date(t).add(n,"months").toDate()},t.prototype.addYearsToDate=function(t,n){return e.date(t).add(n,"years").toDate()},t.prototype.getLastDayOfMonth=function(){return e.date().endOf("month").toDate()},t.prototype.getFirstDayOfMonth=function(){var t=e.date();return 1!==t.date()&&t.add(1,"month").startOf("month"),t.toDate()},t.prototype.getLastFridayOfMonth=function(){var t=e.date().endOf("month");return t.day()>=5?t.subtract(t.day()-5,"days"):t.subtract(t.day()+2,"days"),t.toDate()},t.prototype.getLastDayOfMonthPlusTime=function(t,n){return e.date(t).add(n-1,"month").endOf("month").toDate()},t.prototype.getFirstDayOfMonthPlusTime=function(t,n){var a=e.date(t).clone();return 0===a.day()?(a.add(n-1,"months").startOf("month"),t=a.isBefore(t)?a.add(1,"months"):a):t=e.date(t).add(n,"months").startOf("month"),t.toDate()},t.prototype.getLastFridayOfMonthPlusTime=function(t,n){var a=e.date(t).clone(),r=function(e){return e.subtract(1,"week").endOf("week").subtract(1,"days")};return 5!==a.endOf("month").day()?(r(a),a.isBefore(t)?a.add(n,"months"):a.add(n-1,"months"),5!==a.endOf("month").day()&&r(a)):(a.add(n-1,"months").endOf("month"),5!==a.day()&&r(a)),t=a.toDate(),t=a.toDate()},t.prototype.calculateMinimumEndDate=function(t,n,a){switch(t){case this.frequencies.WEEKLY:a=e.date(a).add(1*n,"weeks").toDate();break;case this.frequencies.MONTHLY:
a=e.date(a).add(1*n,"months").toDate();break;case this.frequencies.YEARLY:a=e.date(a).add(1*n,"years").toDate();break;case this.frequencies.LAST_FRIDAY_OF_THE_MONTH:a=this.getLastFridayOfMonthPlusTime(a,1);break;case this.frequencies.START_OF_THE_MONTH:a=this.getFirstDayOfMonthPlusTime(a,1);break;case this.frequencies.END_OF_THE_MONTH:a=this.getLastDayOfMonthPlusTime(a,1)}return a},{getInstance:function(e){return new t(e)}}},exports.ScheduledDateCalculator.$inject=["lpCoreUtils"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};n=function(require,exports,e){"use strict";exports.scheduledTransfer=function(e){var t="";return t+='<div class="lp-scheduled-transfer">',t+='    <div class="lp-st-frequency lp-st-section clearfix">',t+='        <div class="pull-left lp-st-caption">Frequency</div>',t+='        <div class="pull-left lp-st-control">',t+='            <div class="lp-st-frequency-dropdown" aria-label="frequency" dropdown-select="dropdown-select" ng-change="frequencyChanged()" ng-model="paymentOrder.scheduledTransfer.frequency" options="val.id as val.value group by val.group for val in frequencies"></div>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-every lp-st-section clearfix">',t+='        <div class="pull-left lp-st-caption" ng-if="customOrder">Every</div>',t+='        <div class="pull-left lp-st-control clearfix" ng-if="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.WEEKLY">',t+='            <input type="number" lp-number-input="lp-number-input" lp-max-length="1" min="1" step="0" non-zero="non-zero" class="lp-st-every-input pull-left" name="repeatEvery" required="required" tabindex="0" aria-required="true" aria-label="Repeat weekly transfer every" maxlength="2" ng-model="paymentOrder.scheduledTransfer.every" ng-change="setEndDate()" /><span>week(s) on:</span>',t+="        </div>",t+='        <div class="pull-left lp-st-control clearfix" ng-if="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.MONTHLY">',t+='            <input type="number" lp-number-input="lp-number-input" lp-max-length="1" min="1" step="0" non-zero="non-zero" class="lp-st-every-input pull-left" name="repeatEvery" required="required" tabindex="0" aria-required="true" aria-label="Repeat monthly transfer every" maxlength="2" ng-model="paymentOrder.scheduledTransfer.every" ng-change="setEndDate()" /><span>month(s) on:</span>',t+="        </div>",t+='        <div class="pull-left lp-st-control clearfix" ng-if="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.YEARLY">',t+='            <input type="number" lp-number-input="lp-number-input" lp-max-length="1" min="1" step="0" non-zero="non-zero" class="lp-st-every-input pull-left" name="repeatEvery" required="required" tabindex="0" aria-required="true"  aria-label="Repeat yearly transfer every" maxlength="2" ng-model="paymentOrder.scheduledTransfer.every" ng-change="setEndDate()" /><span>year(s):</span>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-interval lp-st-section clearfix" ng-if="customOrder">',t+='        <div class="lp-st-interval-menu weekly btn-group" ng-if="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.WEEKLY">',t+='            <button type="button" interval-button="interval-button" aria-label="{{day.label}}" ng-class="{\'active\': day.active}" class="btn btn-default" tabindex="0"  ng-click="toggleInterval($index)" ng-repeat="day in days" ng-model="day">{{day.value}}</button>',t+="        </div>",t+='        <div class="lp-st-interval-menu monthly btn-group" ng-if="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.MONTHLY">',t+='            <button type="button" interval-button="interval-button" aria-label="{{date.label}}" ng-class="{\'active\': date.active}" class="btn btn-default" tabindex="0"  ng-click="toggleInterval($index)" ng-repeat="date in dates" ng-model="date">{{date.value}}</button>',t+="        </div>",t+='        <div class="lp-st-interval-menu yearly btn-group" ng-if="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.YEARLY">',t+='            <button type="button" interval-button="interval-button" aria-label="{{month.label}}" ng-class="{\'active\': month.active}" class="btn btn-default" tabindex="0" ng-click="toggleInterval($index)" ng-repeat="month in months" ng-model="month">{{month.value}}</button>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-start-date lp-st-section clearfix">',t+='        <div class="pull-left lp-st-caption">Start</div>',t+='        <div class="pull-left lp-st-control calendar">',t+='            <input ng-click="openStartCalendar($event)" aria-label="start date" type="text" ng-required="paymentOrder.isScheduledTransfer === true" name="startDate" ng-model="paymentOrder.scheduledTransfer.startDate" datepicker-popup="d-MMM-yyyy" readonly="readonly" is-open="calendar.startCalendarOpen" datepicker-options="startDateOptions" min-date="todaysDate" class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-change="setEndDate()" ng-keypress="openStartCalendar($event)" />',t+='            <span ng-click="openStartCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-end-on lp-st-section clearfix">',t+='        <div class="pull-left lp-st-caption">End</div>',t+='        <div class="pull-left lp-st-control">',t+='            <div class="lp-st-end-on-dropdown" aria-label="end on" dropdown-select="dropdown-select" ng-change="endOnChanged()" ng-model="paymentOrder.scheduledTransfer.endOn" options="val.id as val.value for val in endOptions"></div>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-end-after lp-st-section clearfix" ng-if="paymentOrder.scheduledTransfer.endOn === \'after\'">',t+='        <div class="pull-left lp-st-caption">Repeat</div>',t+='        <div class="pull-left lp-st-control">',t+='            <input type="number" lp-number-input="lp-number-input" lp-max-length="2" min="1" step="0" non-zero="non-zero" class="form-control" aria-label="times to repeat" name="timesToRepeat" aria-required="true" required="required" tabindex="0" ng-model="paymentOrder.scheduledTransfer.timesToRepeat" ng-change="setEndDate()"  />',t+="        </div>",t+="",t+="    </div>",t+='    <p class="text-muted" ng-if="paymentOrder.scheduledTransfer.endOn === \'after\' && timesEndDate.length > 0" style="margin-left: 5px;">Completion date: {{timesEndDate}}</p>',t+='    <div class="lp-st-end-date lp-st-section clearfix" ng-if="paymentOrder.scheduledTransfer.endOn === \'onDate\'">',t+='        <div class="pull-left lp-st-caption">End date</div>',t+='        <div class="pull-left lp-st-control calendar">',t+='            <input ng-click="openEndCalendar($event)" aria-label="end date" type="text" ng-required="paymentOrder.isScheduledTransfer === true" name="endDate" ng-model="paymentOrder.scheduledTransfer.endDate" readonly="readonly" datepicker-popup="d-MMM-yyyy" is-open="calendar.endCalendarOpen" datepicker-options="endDateOptions" min-date="minEndDate" class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-keypress="openEndCalendar($event)" />',t+='            <span ng-click="openEndCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>',t+="        </div>",t+="    </div>",t+='    <p ng-if="dateWarning">Transfer will be put through on the last day of the month if the month is not long enough</p>',t+="</div>",t+="",{restrict:"AE",replace:!0,require:["ngModel","^form"],template:t,link:function(t,n,r,i){var o,s=function(){t.todaysDate=new Date,t.minEndDate=new Date,t.frequenciesEnum={START_OF_THE_MONTH:"START_OF_THE_MONTH",END_OF_THE_MONTH:"END_OF_THE_MONTH",LAST_FRIDAY_OF_THE_MONTH:"LAST_FRIDAY_OF_THE_MONTH",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"},o=e.getInstance({frequencies:t.frequenciesEnum}),t.frequencies||(t.frequencies=[{id:t.frequenciesEnum.START_OF_THE_MONTH,value:"First of the month",group:"apreset"},{id:t.frequenciesEnum.END_OF_THE_MONTH,value:"End of the month",group:"apreset"},{id:t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH,value:"Last Friday of the month",group:"apreset"},{id:t.frequenciesEnum.WEEKLY,value:"Weekly",group:"bcustom"},{id:t.frequenciesEnum.MONTHLY,value:"Monthly",group:"bcustom"},{id:t.frequenciesEnum.YEARLY,value:"Yearly",group:"bcustom"}]),t.days=[{id:1,value:"M",label:"Monday",active:!1},{id:2,value:"T",label:"Tuesday",active:!1},{id:3,value:"W",label:"Wednesday",active:!1},{id:4,value:"T",label:"Thursday",active:!1},{id:5,value:"F",label:"Friday",active:!1},{id:6,value:"S",label:"Saturday",active:!1},{id:7,value:"S",label:"Sunday",active:!1}],t.months=[{id:1,value:"Jan",label:"January",active:!1},{id:2,value:"Feb",label:"February",active:!1},{id:3,value:"Mar",label:"March",active:!1},{id:4,value:"Apr",label:"April",active:!1},{id:5,value:"May",label:"May",active:!1},{id:6,value:"Jun",label:"June",active:!1},{id:7,value:"Jul",label:"July",active:!1},{id:8,value:"Aug",label:"August",active:!1},{id:9,value:"Sep",label:"September",active:!1},{id:10,value:"Oct",label:"October",active:!1},{id:11,value:"Nov",label:"November",active:!1},{id:12,value:"Dec",label:"December",active:!1}],t.dates=[];for(var n=1;n<32;n++)t.dates.push({id:n,value:n,label:n,active:!1});t.endOptions||(t.endOptions=[{id:"after",value:"After"},{id:"onDate",value:"On date"}]),t.paymentOrder.scheduledTransfer.endOn=t.endOptions[0].id,t.customOrder=!1,t.dateWarning=!1,t.calendar={startCalendarOpen:!1,endCalendarOpen:!1},t.endDateOptions={datepickerMode:"year","show-weeks":!1},t.startDateOptions={"show-weeks":!1},t.timesEndDate=t.paymentOrder.scheduledTransfer.endDate,t.setEndDate()},l=i[0],c=i[1];l.$name="scheduledTransfer",c.$addControl(l),l.$formatters.push(function(e){if(e.intervals.length>0){var n,a;if(e.frequency===t.frequenciesEnum.WEEKLY){for(n=0;n<e.intervals.length;n++)for(a=0;a<t.days.length;a++)if(e.intervals[n]===t.days[a].id){t.days[a].active=!0;break}}else if(e.frequency===t.frequenciesEnum.MONTHLY){for(n=0;n<e.intervals.length;n++)for(a=0;a<t.dates.length;a++)if(e.intervals[n]===t.dates[a].id){t.dates[a].active=!0;break}}else if(e.frequency===t.frequenciesEnum.YEARLY)for(n=0;n<e.intervals.length;n++)for(a=0;a<t.months.length;a++)if(e.intervals[n]===t.months[a].id){t.months[a].active=!0;break}}t.paymentOrder.scheduledTransfer.frequency=""===e.frequency?t.frequencies[0].id:e.frequency,f()?t.customOrder=!0:t.customOrder=!1,p(),t.setTransferPeriodDates()}),t.frequencyChanged=function(){d(),t.setTransferPeriodDates(),f()?(t.customOrder=!0,u(),t.paymentOrder.scheduledTransfer.customOrder=!0):(t.customOrder=!1,l.$setValidity("intervalsRequired",!0),t.paymentOrder.scheduledTransfer.customOrder=!1),p()},t.toggleInterval=function(e){var n,a;if(t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY?n=t.days:t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY?n=t.dates:t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY&&(n=t.months),a=n[e],a.active){var r=t.paymentOrder.scheduledTransfer.intervals.indexOf(a.id);t.paymentOrder.scheduledTransfer.intervals.splice(r,1)}else t.paymentOrder.scheduledTransfer.intervals.push(a.id);a.active=!a.active,u(),p(),t.setEndDate()};var u=function(){var e=!0;e=t.paymentOrder.scheduledTransfer.intervals.length>0,e=!t.customOrder||e,e=!t.paymentOrder.isScheduledTransfer||e,l.$setValidity("intervalsRequired",e)},d=function(){t.paymentOrder.scheduledTransfer.intervals=[];var e;for(e=0;e<t.days.length;e++)t.days[e].active=!1;for(e=0;e<t.dates.length;e++)t.dates[e].active=!1;for(e=0;e<t.months.length;e++)t.months[e].active=!1};t.openStartCalendar=function(e){"click"!==e.type&&32!==e.which&&13!==e.which||(e.preventDefault(),e.stopPropagation(),t.calendar.endCalendarOpen=!1,t.calendar.startCalendarOpen=!t.calendar.startCalendarOpen)},t.openEndCalendar=function(e){"click"!==e.type&&32!==e.which&&13!==e.which||(e.preventDefault(),e.stopPropagation(),t.calendar.startCalendarOpen=!1,t.calendar.endCalendarOpen=!t.calendar.endCalendarOpen)},t.setTransferPeriodDates=function(){"object"!==a(t.paymentOrder.scheduledTransfer.startDate)&&(f()?t.paymentOrder.scheduledTransfer.startDate=new Date(t.todaysDate.getTime()):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.END_OF_THE_MONTH?t.paymentOrder.scheduledTransfer.startDate=o.getLastDayOfMonth():t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.START_OF_THE_MONTH?t.paymentOrder.scheduledTransfer.startDate=o.getFirstDayOfMonth():t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(t.paymentOrder.scheduledTransfer.startDate=o.getLastFridayOfMonth())),t.setEndDate()},t.setEndDate=function(){var e;if(t.paymentOrder.scheduledTransfer.startDate){var n=new Date(t.paymentOrder.scheduledTransfer.startDate.getTime());f()?(e=t.paymentOrder.scheduledTransfer.timesToRepeat*t.paymentOrder.scheduledTransfer.every,t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY?n=o.addWeeksToDate(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY?n=o.addMonthsToDate(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY&&(n=o.addYearsToDate(n,e))):(e=t.paymentOrder.scheduledTransfer.timesToRepeat,e=t.paymentOrder.scheduledTransfer.timesToRepeat,t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.END_OF_THE_MONTH?n=o.getLastDayOfMonthPlusTime(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.START_OF_THE_MONTH?n=o.getFirstDayOfMonthPlusTime(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(n=o.getLastFridayOfMonthPlusTime(n,e))),t.paymentOrder.scheduledTransfer.endDate=n,t.minEndDate=o.calculateMinimumEndDate(t.paymentOrder.scheduledTransfer.frequency,t.paymentOrder.scheduledTransfer.every,new Date(t.paymentOrder.scheduledTransfer.startDate.getTime())),t.timesEndDate=new Date(t.paymentOrder.scheduledTransfer.endDate.getTime()).toString("d-MMM-yyyy")}};var p=function(){var e=!1;if(t.paymentOrder.scheduledTransfer.intervals.length>0&&t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY)for(var n=28;n<31;n++)t.dates[n].active&&(e=!0);t.dateWarning=e};t.$watch("paymentOrder.isScheduledTransfer",function(e){u()}),t.$on("reset",function(){t.paymentOrder.scheduledTransfer.frequency=t.frequencies[0].id,t.customOrder=!1,t.paymentOrder.scheduledTransfer.customOrder=!1});var f=function(){return t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY||t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY||t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY};s()}}},exports.scheduledTransfer.$inject=["ScheduledDateCalculator"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){e.name="module-payments-migration";var n=t(8),a=[];e.exports=n.createModule(e.name,a).directive(t(25)).directive(t(26)).directive(t(27)).directive(t(28)).directive(t(29)).filter(t(30)).factory(t(31)).directive(t(32)).directive(t(33)).directive(t(34)).directive(t(35)).directive(t(36)).directive(t(37)).directive(t(38)).directive(t(39)).directive(t(40))}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(7)(e))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.addressTransfer=function(e,t){return e.put("$addressTransferTemplate.html",'<div class="lp-address-transfer"><div class="col-xs-12"><input type="input" class="form-control" ng-model="address.addressOne" placeholder="Address Line 1" aria-label="Address Line One" /><input type="input" class="form-control" ng-model="address.addressTwo" placeholder="Address Line 2" aria-label="Address Line Two"  /></div><div class="col-xs-12"><input type="input" class="form-control" ng-model="address.city" placeholder="City" aria-label="City" /></div><div class="col-xs-12"><div class="col-xs-5"><input type="input" class="form-control" ng-model="address.state" placeholder="State" aria-label="State" /></div><div ng-class="{\'col-xs-offset-1\': true, \'col-xs-6\': true, \'has-feedback\': address.zip.length > 0, \'has-error\': address.zip.length > 0 && !validZip, \'has-success\': address.zip.length > 0 && validZip}"><input type="input" class="form-control" ng-model="address.zip" placeholder="Zip" aria-label="Zip" /><span ng-if="validZip && address.zip.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validZip && address.zip.length > 0" ng-click="clear()" class="glyphicon glyphicon-remove form-control-feedback"></span></div></div><div class="warning"><span>Selecting this means a cheque will be printed and posted on your behalf. Can take 7-14 days.</span></div></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{counterpartyAddress:"=ngModel",transferType:"=lpTransferType"},template:e.get("$addressTransferTemplate.html"),link:function(e,n,a,r){var i=function(){e.address={addressOne:"",addressTwo:"",city:"",state:"",zip:""},d(e.transferType)},o=r[0],s=r[1],l=t.p2pAddress;o.$name=a.name,s.$addControl(o),o.$formatters.push(function(e){return c(e),e});var c=function(t){var n=!0,a=!0,r=!0,i=!0,s=!0;if(t){var l=t.split(", ");e.address.addressOne=l[0],e.address.addressTwo=l[1],e.address.city=l[2],e.address.state=l[3],e.address.zip=l[4],0===l[0].length&&(n=!1),0===l[2].length&&(a=!1),0===l[3].length&&(r=!1),0===l[4].length?i=!1:s=u(l[4])}o.$setValidity("addressLineOne",n),o.$setValidity("addressCity",a),o.$setValidity("addressState",r),o.$setValidity("addressZip",i),o.$setValidity("addressValidZip",s)},u=function(t){var n=/^\d{5}(-\d{4})?$/,a=n.test(t);return e.validZip=a,a};e.$watch("address",function(t,n){t!==n&&(e.counterpartyAddress=t.addressOne+", "+t.addressTwo+", "+t.city+", "+t.state+", "+t.zip)},!0),e.$watch("transferType",function(e,t){e!==t&&d(e)});var d=function(t){t===l?c(e.counterpartyAddress||""):(o.$setValidity("addressLineOne",!0),o.$setValidity("addressCity",!0),o.$setValidity("addressState",!0),o.$setValidity("addressZip",!0),o.$setValidity("addressValidZip",!0))};i()}}},exports.addressTransfer.$inject=["$templateCache","transferTypes"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=window.jQuery,a=t(8),r=a.ng,i=a.inject("lpUIUtils",t(11).name);exports.counterPartyFilter=function(e,t,a,o,s,l){return e.put("$counterPartyFilter.html",'<div class="lp-counter-party-filter"><div class="input-group has-clear"><input class="name-field form-control" type="text" ng-model="counterpartyName" ng-click="showContactList()" ng-keydown="showContactList($event)" aria-label="Counterparty Name" /><span class="counterparty-to text-muted">To:</span><span class="input-clear" ng-click="clearCounterParty()" ng-show="counterpartyName.length"><i class="glyphicon glyphicon-remove cursor-pointer"></i></span><span class="input-group-btn"><button type="button" role="button" aria-label="Auto Suggest" tabindex="0" class="btn btn-default dropdown-toggle" ng-click="toggleShowContacts()"><i class="lp-icon lp-icon-addressbook"></i></button></span></div><div class="dropdown"><ul ng-show="showContacts && (counterpartyList | filter:counterpartyName).length > 0" class="col-xs-12 dropdown-menu filter-list" style="display: block;"><li class="contact" ng-repeat="contact in counterpartyList | filter: counterpartyName | limitTo: 25 track by $index" ><div class="border" ng-class="{\'border-my-accounts\': contact.ownAccounts, \'border-other\': !contact.ownAccounts}"></div><div class="filter-contact clearfix" ng-class="{\'single-account-selection\': contact.accounts.length === 1}" ng-click="prepareSelection(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)" dynamic-focus="contact"><div class="pull-left photo-container"><img class="contact-photo media-object" ng-src="{{getProfileImageByName(contact.photoUrl,contact.name)}}" /></div><div class="contact-info pull-left contact-details"><span class="contact-name">{{contact.name}}</span><p class="account-info" ng-if="contact.accounts.length > 1">{{contact.accounts.length}} account(s)</p><p class="account-info" ng-if="contact.accounts.length === 1">{{contact.accounts[0].account}}</p></div><div ng-if="contact.accounts.length > 1" class="pull-left contact-account-list"><p tabindex="0" class="toggle-accounts" ng-show="!contact.open" ng-click="toggleContactAccounts(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)"  aria-label="View accounts for {{contact.name}}">View all accounts <span class="caret"></span></p><p tabindex="0" class="toggle-accounts" ng-show="contact.open" ng-click="toggleContactAccounts(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)" aria-label="Close accounts for {{contact.name}}">Close all accounts <span class="caret"></span></p><div class="contact-accounts" ng-class="{\'contact-accounts-open\': contact.open}"><div tabindex="0" ng-show="contact.open" ng-repeat="account in contact.accounts track by $index" class="contact-single-account" ng-click="prepareSelection(contact, account)" ng-keydown="handleSingleAccountKeyDown(contact, account, $event)" dynamic-aria-label="dynamic-aria-label" aria-contact="contact" aria-account="account"><div class="col-xs-10 col-xs-offset-2"><p ng-if="account.name">{{account.name}}</p><p>{{account.account}}</p></div></div></div></div></div></li></ul></div></div>'),{restrict:"A",scope:{counterpartyName:"=ngModel",contacts:"=lpContacts",accounts:"=lpAccounts",profile:"=lpProfile",onSelect:"="},require:["ngModel","^form"],template:e.get("$counterPartyFilter.html"),link:function(e,o,c,u){var d=u[0],p=u[1];d.$name=c.name,p.$addControl(d);var f=r.element(o.find("input")),m=o.get(0),h={up:38,down:40,enter:13},v={email:t.p2pEmail,account:t.bank},y=function(){e.counterpartyList=[],e.showContacts=!1,e.deregisterProfileWatch=e.$watch("profile",function(t){console.log(t),t&&(t.fullname=[t.firstName,t.lastName].join(" "),t.activities.lastLoggedIn={key:"Last Logged In",value:t.activities.lastLoggedIn},l.map(t.details,function(e){e.key=l.startCase(e.key)}),e.profile=t,e.deregisterContactsWatch=e.$watch("contacts",function(t){t.length>0&&(g(e.contacts),e.deregisterContactsWatch())}),e.deregisterAccountsWatch=e.$watch("accounts",function(t){t.length>0&&(b(e.accounts),e.deregisterAccountsWatch())}))}),e.accountsConfigured=!1,e.contactsConfigured=!1};d.$formatters.push(function(e){return e.length>0?d.$setValidity("required",!0):d.$setValidity("required",!1),e}),d.$parsers.push(function(e){return e.length>0?d.$setValidity("required",!0):d.$setValidity("required",!1),e});var g=function(t){for(var n,a=0;a<t.length;a++){n=t[a],n.open=!1,n.accounts=[];for(var r in n)n.hasOwnProperty(r)&&v[r]&&n[r]&&n.accounts.push({type:v[r],account:n[r]});e.counterpartyList.push(n)}},b=function(n){var a={};a.name=e.profile.fullname,a.open=!1,a.ownAccounts=!0,a.accounts=[];for(var r=0;r<n.length;r++)a.accounts.push({type:t.bank,account:n[r].identifier,name:n[r].alias});e.counterpartyList.unshift(a)},T=function(){a.bind("click",function(t){m.contains(t.target)||(e.$apply(function(){e.showContacts=!1}),O())})},O=function(){a.unbind("click")},E=function(){return n(o.find(".contact")[0])},w=function(e){var t;e=r.element(event.target),e.next().hasClass("toggle-accounts")?t=e.next():e.prev().hasClass("toggle-accounts")&&(t=e.prev()),t&&setTimeout(function(){t.focus()},0)},C=function(e){return e.find(".toggle-accounts")},D=function(e){var t;t="block"===n(e[0]).css("display")?e[0]:e[1],t&&setTimeout(function(){t.focus()},0)},q=function(e){return e.parents(".contact")};e.toggleShowContacts=function(){e.showContacts=!e.showContacts,e.showContacts?T():O()},e.clearCounterParty=function(){e.counterpartyName="",e.showContacts=!0,T(),e.onSelect(),o.find(f)[0].focus()},e.$on("reset",function(){e.showContacts=!1}),e.showContactList=function(t){if(O(),!t||t.which===h.enter||t.which===h.down||t.which===h.up)if(t&&(t.preventDefault(),t.stopPropagation()),T(),e.showContacts)if(t&&t.which===h.down){var n=E(),a=C(n);a.length>0?D(a):n.find(".filter-contact").focus()}else!t||t.which!==h.up&&t.which!==h.enter||(e.showContacts=!1,O());else e.showContacts=!0},e.toggleContactAccounts=function(t){for(var n=0;n<e.counterpartyList.length;n++)e.counterpartyList[n]===t?e.counterpartyList[n].open=!e.counterpartyList[n].open:e.counterpartyList[n].open=!1},e.handleContactAccountToggleKeyDown=function(t,n){n.preventDefault(),n.stopPropagation(),n.which===h.enter?1===t.accounts.length?e.prepareSelection(t):(e.toggleContactAccounts(t),w(n.target)):n.which!==h.down&&n.which!==h.up||e.keyToNextAccountToggle(n)},e.handleSingleAccountKeyDown=function(t,n,a){a.preventDefault(),a.stopPropagation(),a.which===h.enter?e.prepareSelection(t,n):a.which!==h.down&&a.which!==h.up||e.keyToNextAccount(a)},e.keyToNextAccountToggle=function(e){var t,a=n(e.target),r=q(a);if(e.which===h.down)if(a.next("div").length>0)r.find(".contact-single-account")[0].focus();else{var i=r.next(".contact");t=C(i),t.length>0?D(t):i.find(".filter-contact").focus()}else if(e.which===h.up){var o=r.prev(".contact");t=C(o),t.length>0?D(t):o.find(".filter-contact").length>0?o.find(".filter-contact").focus():f.focus()}},e.keyToNextAccount=function(e){var t,a,r,i=n(e.target);e.which===h.down?1===i.next(".contact-single-account").length&&(t=i.next(".contact-single-account")):e.which===h.up&&(1===i.prev(".contact-single-account").length?t=i.prev(".contact-single-account"):(a=q(i),r=C(a),r.length>0&&D(r))),t&&setTimeout(function(){t.trigger("focus")},0)},e.prepareSelection=function(t,n){if(!n){if(t.accounts.length>1)return;n=t.accounts[0]}e.showContacts=!1,O(),d.$setViewValue(t.name),e.onSelect(n),setTimeout(function(){f.focus()},0)},e.getProfileImageByName=function(e,t){return e?i.decodePhotoUrl(e):t?i.getDefaultProfileImage(t,100,100):(s.throwException("Expected a name but got "+t),"")},y()}}},exports.counterPartyFilter.$inject=["$templateCache","transferTypes","$document","lpUserDetails","lpCoreError","lpCoreUtils"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.dynamicAriaLabel=function(){return{restrict:"A",scope:{contact:"=ariaContact",account:"=ariaAccount"},link:function(e,t){var n="";if(n+=e.contact.name+" ",e.account.name)n+=e.account.name+" ";else{var a=e.account.type.toLowerCase();a=a.replace("_"," "),n+=a+" "}n+=e.account.account,t.attr("aria-label",n)}}}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.dynamicFocus=function(){return{restrict:"A",scope:{contact:"=dynamicFocus"},link:function(e,t){1===e.contact.accounts.length&&(t.attr("tabindex","0"),t.attr("aria-label",e.contact.name+" "+e.contact.accounts[0].type.toLowerCase()+" "+e.contact.accounts[0].account))}}}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=t(8),a=n.ng,r=n.inject("lpCoreUtils",t(9).name);exports.emailTransfer=function(e,t){return e.put("$emailTransferTemplate.html","<div class=\"lp-email-transfer\"><div ng-class=\"{'email-input': true, 'has-feedback': email.length > 0, 'has-success': email.length > 0 && validEmail, 'has-error': email.length > 0 && !validEmail}\">"+'<input type="input" ng-model="email" ng-keyup="handleAutoSuggest($event)" placeholder="Email address" class="form-control" aria-label="Email Address" /><span ng-if="validEmail && email.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validEmail && email.length > 0" ng-click="clear()" style="cursor: pointer;" class="glyphicon glyphicon-remove form-control-feedback"></span></div><span ng-if="autoSuggestActive">Did you mean <span ng-click="doAutoSuggest()" class="auto-correct-suggestion">{{autoSuggestion}}</span>?<br /></span><span class="text-muted" style="font-size: 13px;">Transfers up to $10.00 will be free of charge. For transfers above $10.00 a fee of $0.25 per transaction will be charged and debited from your account</span></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{email:"=ngModel",transferType:"=lpTransferType"},template:e.get("$emailTransferTemplate.html"),link:function(e,n,i,o){var s,l=function(){e.validEmail=!1,e.autoSuggestActive=!1,e.autoSuggestion="",s=a.element(n.find("input")[0]);var t={gmail:"gmail",yahoo:"yahoo",backbase:"backbase"};e.suggestionsMap={gmaik:t.gmail,gmain:t.gmail,gmal:t.gmail,gmakl:t.gmail,mgail:t.gmail,yaho:t.yahoo,yahooo:t.yahoo,yagoo:t.yahoo,bakbase:t.backbase,backbas:t.backbase,baclbase:t.backbase}},c=o[0],u=o[1],d=t.p2pEmail;c.$name=i.name,u.$addControl(c),c.$formatters.push(function(t){return void 0===t&&null===t||(e.validEmail=p(t?t.toLowerCase():"")),t&&t.indexOf("@")===-1&&(e.autoSuggestActive=!1),t}),e.clear=function(){e.email=""},e.handleAutoSuggest=function(t){var n,a;190===t.which?e.email.indexOf("@")>-1&&(n=e.email.split("@"),n[1]&&""!==n[1]&&(a=f(n[1]),void 0!==e.suggestionsMap[a]&&(e.autoSuggestion=e.suggestionsMap[a],e.autoSuggestActive=!0))):"[object KeyboardEvent]"===t.originalEvent.toString()&&8===t.which&&e.email.indexOf("@")>-1&&(n=e.email.split("@"),n[1]&&""!==n[1]&&(a=f(n[1]),void 0===e.suggestionsMap[a]&&(e.autoSuggestion="",e.autoSuggestActive=!1)))},e.doAutoSuggest=function(){var t=e.email.split("@");if(t[1]){var n=f(t[1]);t[1]=t[1].replace(n,e.autoSuggestion),e.email=t.join("@"),e.autoSuggestActive=!1,e.autoSuggestion=""}};var p=function(t){if(0===t.length&&e.transferType===d)return c.$setValidity("emailRequired",!1),!1;if(e.transferType===d){c.$setValidity("emailRequired",!0);var n=r.isValidEmail(t);return c.$setValidity("validEmailRequired",n),n}},f=function(e){var t,n=e.indexOf(".");return t=n>-1?e.substring(0,n):e};e.$watch("transferType",function(t,n){t!==d?(c.$setValidity("emailRequired",!0),c.$setValidity("validEmailRequired",!0)):e.validEmail=p(e.email)}),l()}}},exports.emailTransfer.$inject=["$templateCache","transferTypes"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.addSeperator=function(){var e=" ",t=function(t){return 4===t.length&&(t+=e),t};return function(n){if(n){n=n.split(e).join(""),n=n.toUpperCase();for(var a=n.match(/.{1,4}/g),r="",i=0;i<a.length;i++)i!==a.length-1&&(a[i]=t(a[i])),r+=a[i];return r}}},exports.addSeperator=function(){var e=" ",t=function(t){return 4===t.length&&(t+=e),t};return function(n){if(n){n=n.split(e).join(""),n=n.toUpperCase();for(var a=n.match(/.{1,4}/g),r="",i=0;i<a.length;i++)i!==a.length-1&&(a[i]=t(a[i])),r+=a[i];return r}}}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=t(8),a=n.ng,r=n.inject("lpCoreUtils",t(9).name);exports.IbanModel=function(e){var t=function(t){this.enableCountrySearch=t.enableCountrySearch,this.countryListService=e.getInstance({endpoint:t.countryListEndpoint}),this.value="",this.valid=!1,this.countryList=[],this.selectedCountry={}};return t.prototype.loadCountryList=function(){var e=this,t=e.countryListService.read();return t.then(function(t){e.countryList=t.data},function(){e.error="countryListServiceError"}),t},t.prototype.getCountryCode=function(e){var t=this,n=null,r=e||t.value;if(r.match(/^[A-Za-z]{2}/g)){var i=r.substr(0,2);a.forEach(t.countryList,function(e){if(e.country_code===i.toUpperCase())return n=i,void(t.selectedCountry=e)})}return n},t.prototype.normalizeIban=function(e){return e&&(e=e.toUpperCase(),e=e.replace(/[\-\. ]/g,"")),e||""},t.prototype.validate=function(){
if(this.value.length!==parseInt(this.selectedCountry.iban_length,10))return this.valid=!1,!1;var e=new RegExp(this.selectedCountry.iban_regex);return e.test(this.value)&&r.isValidISO7064Checksum(this.value)?(this.valid=!0,!0):(this.valid=!1,!1)},{getInstance:function(e){return new t(e)}}},exports.IbanModel.$inject=["httpService"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var t=function(e){var t=function(){e.wholeAmount="",e.decimalAmount="",e.amountInDomesticCurrency="0.00",e.fieldLength=6};t()};t.$inject=["$scope"],exports.lpCurrencyAmountInput=function(e){return e.put("$currencyAmountTemplate.html",'<div class="lp-currency-amount-input"><div class="clearfix"><div class="select-area pull-left"><div class="currency-select" ng-hide="lpDisableCurrencySelection" dropdown-select="dropdown-select" empty-placeholder-text="EUR" ng-model="lpCurrencyList.selected" options="val as val.currency_code group by val.group for val in lpCurrencyList.orderedCurrencies" ng-hide="lpCurrencyList.error" aria-required="true" aria-label="currency"></div></div><div class="amount-area pull-left" ng-class="{\'input-group\': lpAmountLabel}"><span class="input-group-addon lp-amount-label" ng-if="lpAmountLabel">{{lpAmountLabel}}</span><input name="wholeAmountInput" type="number" lp-number-input="lp-number-input" lp-max-length="fieldLength" min="0" step="1" class="form-control whole-amount-input pull-left" ng-model="wholeAmount" placeholder="{{lpAmountPlaceholder || \'Amount\'}}" aria-required="true" aria-label="amount" /><div  class="pull-left decimal"><span class="decimal-point">.</span></div><input type="text" pattern="[0-9]" lp-number-input="lp-number-input" lp-max-length="2" min="0" step="1" class="form-control pull-left decimal-amount-input" ng-model="decimalAmount" placeholder="00"  aria-required="true" aria-label="decimal amount" /></div></div><div class="info"><div ng-hide="lpDisableCurrencySelection || lpCurrencyList.error || lpCurrencyList.selected === lpCurrencyList.defaultCurrency" class="info-message"><span class="text-muted">This transfer is {{amountInDomesticCurrency}} in {{lpCurrencyList.defaultCurrency.currency_code}}<i class="lp-icon lp-icon-xxl lp-icon-info-sign open-popup" ng-click="toggleExchangeRateModal()"></i></span></div></div></div>'),{restrict:"EA",scope:{amount:"=ngModel",lpCurrencyList:"=",lpPaymentOrder:"=",lpDisableCurrencySelection:"=",lpAmountLabel:"@",lpAmountPlaceholder:"@",toggleExchangeRateModal:"=modal"},require:"ngModel",replace:!0,controller:t,template:e.get("$currencyAmountTemplate.html"),link:function(e,t,n,a){var r=t.find(".decimal-amount-input");a.$formatters.push(function(t){if(!t)return t;var n=s();if("0.00"!==t&&""!==t&&t!==n){var a=t.split(".");e.wholeAmount=parseInt(a[0],10),"00"!==a[1]&&(e.decimalAmount=a[1])}return t});var i=function(){var t=e.amount;t/=e.lpCurrencyList.selected.exchange_rate,t=l(t),e.amountInDomesticCurrency=t},o=function(){var t=s(),n=parseInt(e.wholeAmount,10);e.fieldLength&&n.toString().length>e.fieldLength?a.$setValidity("lpCurrencyMaxLength",!1):a.$setValidity("lpCurrencyMaxLength",!0),"0.00"===t?a.$setValidity("lpAmountRequired",!1):t.length>0&&a.$setValidity("lpAmountRequired",!0),e.amount=t,e.lpCurrencyList&&e.lpCurrencyList.orderedCurrencies.length>0&&i()},s=function(){var t=e.decimalAmount,n=parseInt(e.wholeAmount,10),a=/^0[0-9].*$/;n=isNaN(n)?0:n,t<10&&!a.test(t)&&(t="0"+t),t=parseFloat("0."+t);var r=0===t?n:n+t;return r=l(r)},l=function(e){return e.toFixed(2)},c=function(){e.lpPaymentOrder.instructedCurrency=e.lpCurrencyList.selected.currency_code,u()},u=function(){var t=e.fieldLength;e.fieldLength=e.lpCurrencyList.selected.exchange_rate>2?8:6,t>e.fieldLength&&e.wholeAmount.toString().length>6?(e.wholeAmount=parseInt(e.wholeAmount.toString().substring(0,6),10),o()):""===e.wholeAmount&&""===e.decimalAmount||i()};e.$watchCollection("[wholeAmount, decimalAmount]",function(t){t[0]&&t[0].toString().indexOf(".")>-1&&(e.wholeAmount=parseInt(e.wholeAmount.toString().replace(".",""),10),r.focus()),o()}),e.$watch("lpCurrencyList.selected",function(){e.lpCurrencyList&&e.lpCurrencyList.selected&&e.lpCurrencyList.orderedCurrencies.length>1&&c()}),e.$on("reset",function(){e.wholeAmount="",e.decimalAmount="",e.amountInDomesticCurrency="0.00",e.fieldLength=6})}}},exports.lpCurrencyAmountInput.$inject=["$templateCache"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.lpFormatPaymentReference=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=function(t){if(t&&t.length>2){var n=t.substring(0,2);"RF"!==n&&(t="RF"+t)}var a=e("addSeperator")(t);return a!==t&&(r.$setViewValue(a),r.$render()),a};r.$parsers.push(i)}}},exports.lpFormatPaymentReference.$inject=["$filter"];var t=function(e){var t=function(){e.paymentReference="",e.paymentDescription="",e.showInfoMessage=!1,e.paymentRefDisabled=!1,e.paymentDescDisabled=!1};t()};t.$inject=["$scope"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.lpFormatUsAccount=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=function(t){var n=e("addSeperator")(t);return n!==t&&(r.$setViewValue(n),r.$render()),n};r.$parsers.push(i)}}},exports.lpFormatUsAccount.$inject=["$filter"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=window.jQuery,a=t(8),r=(a.ng,a.inject("lpUIUtils",t(11).name));exports.lpIbanInput=function(e,t,a,i){return e.put("$ibanCountryOptionTemplate.html",'<span aria-label="{{option.country_name}}">{{option.country_code}}<span class="country-name"> - {{option.country_name}}</span></span>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{ibanModel:"=lpCountryList",transferType:"=lpTransferType"},template:'<div><div class="lp-iban"><div class="lp-iban-country-dropdown"><div dropdown-select="dropdown-select" empty-placeholder-text="NL" name="ibaneDropdownField" ng-model="iban.selectedCountry" options="country.country_code as country for country in ibanModel.countryList" filter="ibanModel.enableCountrySearch" filter-placeholder-text="Search country" ng-change="change()" option-template-url="$ibanCountryOptionTemplate.html" aria-label="iban country code"></div></div><div class="lp-iban-input" ng-class="{\'has-success\': ibanModel.valid && iban.value.length, \'has-error\': !ibanModel.valid && iban.value.length,  \'has-feedback\': iban.value.length}"><input name="ibanInputField" ng-required="transferType === \'BANK\'" type="input" class="form-control" lp-input-overflow="lp-input-overflow" ng-model="iban.value"  aria-required="true" ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)" ng-change="change()" tabindex="0" placeholder="Enter IBAN or Account Number" aria-label="Enter IBAN or Account Number"><span ng-if="ibanModel.valid && iban.value.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!ibanModel.valid && iban.value.length" ng-click="clear()" class="glyphicon glyphicon-remove form-control-feedback"></span></div></div><span class="text-muted">{{testiban}}</span></div>',link:function(e,a,i,o){var s=o[0],l=o[1],c=a.find("input")[0],u=[],d=!1,p=0,f=n(a[0]),m="BANK";f.find('div[name="ibaneDropdownField"]').on("keypress",function(e){13===e.which&&t(function(){f.find('input[type="search"]').focus()})}),e.iban={},s.$name=i.name,l.$addControl(s),e.$watch("ibanModel.countryList",function(t){e.change(!0),e.ibanModel.countryList.length&&!e.iban.selectedCountry&&(e.iban.selectedCountry=e.ibanModel.countryList[0].country_code)}),s.$formatters.push(function(t){e.ibanModel.value=t,e.iban.value=y(t);var n=e.ibanModel.getCountryCode();e.ibanModel.validate(),n&&e.change(!0);var a=!!n&&e.ibanModel.valid;return s.$setValidity("validIban",a),t}),s.$parsers.push(function(t){var n=!!e.ibanModel.getCountryCode()&&e.ibanModel.validate();return v(t),n?t:void 0});var h=n(document.createElement("span"));h.addClass("lp-input-cursor-position-offset"),h.css("font-size",a.css("font-size")),n(c).after(h);var v=function(t){if(t!==m)s.$setValidity("validIban",!0),s.$setValidity("required",!0),s.$setValidity("parse",!0);else{var n=!!e.ibanModel.getCountryCode()&&e.ibanModel.validate();s.$setValidity("validIban",n)}},y=function(e){var t=[];for(t.push(e.substr(0,2)),e=e.substr(2);e.length>0;)t.push(e.substr(0,4)),e=e.substr(4);return t.join("-")};e.setCursorPosition=function(){var n=r.getNewCaretPosition(c,u,p,d);if(d=!1,n>2&&(n++,n>6)){var a=(n-3)/4;parseInt(a,10)===a&&n--,n+=parseInt(a,10)}t(function(){r.setCaretPositionOfInput(c,n,e.paymentReference,h)},20,!1)},e.getSelection=function(e){var t=function(e){var t=0,n=e;return n>2&&(n-=3,t++),t+=parseInt(n/5,10),e-t};u=r.getSelectionPositionOfInput(c,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&c.value.length&&(d=!0)},e.clear=function(){e.iban.value="",c.focus()},e.change=function(r){if(e.ibanModel.value!==e.ibanModel.normalizeIban(e.iban.selectedCountry+e.iban.value)){var i=e.ibanModel.normalizeIban(e.iban.value);e.ibanModel.getCountryCode(i)||(i=e.iban.selectedCountry+i),p=i.length-e.ibanModel.value.length,e.ibanModel.value=i,s.$setViewValue(i)}var o=e.ibanModel.getCountryCode();o&&(o!==e.iban.selectedCountry&&(e.iban.selectedCountry=o,n(a.find("button")[0]).addClass("lp-country-dropdown-update"),t(function(){n(a.find("button")[0]).removeClass("lp-country-dropdown-update")},200,!1)),e.iban.value=e.ibanModel.value.substr(2)),e.iban.value=y(e.ibanModel.normalizeIban(e.iban.value)),r||e.setCursorPosition()},e.$watch("transferType",function(e,t){v(e)}),v(e.transferType)}}},exports.lpIbanInput.$inject=["$templateCache","$timeout","IbanModel","widget"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.lpInputCurrency=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=/^\d+((\.|\,)\d+)?$/,o=function(e,t,n){r.$setValidity("lpCurrencyFormat",e),e||(t=!0,n=!0),r.$setValidity("lpCurrencyNonZero",t),r.$setValidity("lpCurrencyMaxLength",n)};r.$parsers.unshift(function(t){return t?(t=t.replace(",","."),o(i.test(t),0!==parseFloat(t),t.length<e)):o(!0,!0,!0),t})}}},exports.lpInputCurrency.$inject=["currencyMaxLength"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=t(8),a=n.inject("lpUIUtils",t(11).name),r=n.inject("lpCoreUtils",t(9).name);exports.lpPaymentRefDescription=function(e,t,n){return e.put("$paymentRefDescription.html",'<div class="lp-payment-ref-description"><div ng-hide="hidePaymentReference" class="lp-payment-reference" ng-class="{\'has-success\': isValid && paymentReference.length > 0, \'has-error\': !isValid && paymentReference.length > 0,  \'has-feedback\': paymentReference.length}"><input  class="form-control" aria-label="payment reference" lp-payment-reference-field" type="text" placeholder="Payment reference (optional)" maxlength="31" ng-model="paymentReference" ng-disabled="paymentRefDisabled" lp-input-overflow="lp-input-overflow" ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)" lp-format-payment-reference="lp-format-payment-reference" /><span ng-if="isValid && paymentReference.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="clearRef()" ng-if="!isValid && paymentReference.length" class="glyphicon glyphicon-remove form-control-feedback"></span><div class="lp-input-dividers clearfix"><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div></div></div><div class="lp-payment-description"><textarea aria-label="payment description" class="form-control lp-payment-description-area" placeholder="Description (optional) Maximum number of characters is 140" maxlength="140" ng-model="paymentDescription" ng-disabled="paymentDescDisabled"></textarea></div><div ng-if="!hidePaymentReference" class="hover-catcher" ng-class="{refDisabled: paymentRefDisabled, descDisabled: paymentDescDisabled}" tooltip-placement="top" tooltip="You can only provide a Payment Reference or a Payment Description, not both."></div></div>'),{restrict:"AE",replace:!0,require:["ngModel","^form"],scope:{paymentOrder:"=ngModel",hidePaymentReference:"="},template:e.get("$paymentRefDescription.html"),link:function(e,i,o,s){var l=s[0],c=s[1],u=i.find("input"),d=(i.find(".hover-catcher"),i.find("textarea"),u[0]),p=[],f=!1,m=0;l.$name=o.name;var h=$(document.createElement("span"));h.addClass("lp-input-cursor-position-offset"),h.css("font-size",i.css("font-size")),$(d).after(h),""!==e.paymentOrder.paymentReference?(e.paymentReference=n("addSeperator")(e.paymentOrder.paymentReference),e.paymentDescDisabled=!0):""!==e.paymentOrder.paymentDescription&&(e.paymentDescription=e.paymentOrder.paymentDescription,e.paymentRefDisabled=!0),e.hidePaymentReference&&(e.paymentDescDisabled=!1);var v=function(e){return e.split(" ").join("")},y=function(e){var t=!0;return e.length>25&&(t=!1),e.match(/^RF\d{2}/)||(t=!1),r.isValidISO7064Checksum(e)||(t=!1),t};e.toggleInfoMessage=function(){e.showInfoMessage=!e.showInfoMessage},e.setCursorPosition=function(){var n=a.getNewCaretPosition(d,p,m,f);if(f=!1,n>4){var r=n/4;parseInt(r,10)===r&&n--,n+=parseInt(r,10)}t(function(){a.setCaretPositionOfInput(d,n,e.paymentReference,h)},20,!1)},e.getSelection=function(e){var t=function(e){var t=0;return t+=parseInt(e/5,10),e-t};p=a.getSelectionPositionOfInput(d,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&d.value.length&&(f=!0)},e.clearRef=function(){e.paymentReference="",d.focus()},e.$watch("paymentReference",function(t,n){if(n!==t){if(n||(n=""),t){if(t.length>0){c[l.$name]||c.$addControl(l);var a=v(t);e.isValid=y(a),l.$setValidity("validRef",e.isValid),m=n?a.length-v(n).length:a.length,e.paymentDescDisabled=!0,l.$modelValue.paymentReference=a}}else l.$modelValue.paymentReference="",e.paymentDescDisabled=!1,c.$removeControl(l);e.setCursorPosition()}},!0),e.$watch("paymentDescription",function(t,n){n!==t&&(t?t.length>0&&(e.paymentRefDisabled=!0,l.$modelValue.paymentDescription=t):(e.paymentRefDisabled=!1,l.$modelValue.paymentDescription=""))},!0),e.$on("reset",function(){e.paymentReference="",e.paymentDescription="",e.showInfoMessage=!1,e.paymentRefDisabled=!1,e.paymentDescDisabled=!1})}}},exports.lpPaymentRefDescription.$inject=["$templateCache","$timeout","$filter"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.nonZero=function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){a.$parsers.unshift(function(e){return a.$setValidity("nonZero",0!==parseInt(e,10)),e})}}}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=t(8),a=n.inject("lpCoreUtils",t(9).name);exports.p2pEnrollment=function(e,t){return e.put("$emailTemplate.html",'<div class="lp-p2p-enrollment"><p class="warning">We also need a few details from you to make the transfer</p><div lp-accounts-select="lp-accounts-select" designated-class="lp-normal-account-select-size" ng-model="p2pRegistration.p2pAccount" lp-accounts="accounts" name="p2pAccountSelect" ng-change="onP2PAccountChange()"></div><ul tabset="tabset" class="nav-tabs"><li tab="tab"><span tab-heading="tab-heading" class="tab-heading">Email</span><div ng-class="{\'email-input-form\': true, \'has-feedback\': enrollment.email.length > 0, \'has-success\': enrollment.email.length > 0 && validEmail, \'has-error\': enrollment.email.length > 0 && !validEmail}"><input type="input" class="form-control" ng-model="enrollment.email" placeholder="Confirm your email" ng-change="onEmailChange()" aria-label="Email Address"/><span ng-if="validEmail && enrollment.email.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validEmail && enrollment.email.length > 0" ng-click="clearEmail()" style="cursor: pointer;" class="glyphicon glyphicon-remove form-control-feedback"></span></div></li></ul><div class="ts-and-cs"><div lp-custom-checkbox="" ng-model="p2pRegistration.userAgrees" ng-change="onAgreementChange()" aria-label="{{\'Do you agree with terms and conditions?\' | translate}}"><span style="display:inline-block" lp-i18n="By registering this mobile number or email address, I agree that I am the email or mobile account holder, and I consent to receive email and automated text message about transfers at this time. Fees from carrier may apply"></span></div></div></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{accounts:"=lpAccounts",enrollment:"=ngModel",transferType:"=lpTransferType"},template:e.get("$emailTemplate.html"),link:function(e,n,r,i){var o=i[0],s=i[1];o.$name=r.name,s.$addControl(o);var l=[t.p2pEmail,t.p2pMobile,t.p2pAddress],c=function(){e.p2pRegistration={p2pAccount:{},userAgrees:!1},d(e.transferType)};e.clearEmail=function(){e.enrollment.email=""},e.onP2PAccountChange=function(){e.enrollment.receivingAccountNumber=e.p2pRegistration.p2pAccount.identifier,o.$setValidity("p2pAccountRequired",!0)},e.onEmailChange=function(){u()},e.onAgreementChange=function(){o.$setValidity("termsAndConditions",e.p2pRegistration.userAgrees)},e.$watch("transferType",function(e,t){e!==t&&d(e)});var u=function(){var t;t=e.enrollment?a.isValidEmail(e.enrollment.email):a.isValidEmail(""),o.$setValidity("validEmailRequired",t),e.validEmail=t},d=function(t){for(var n=!1,a=0;a<l.length;a++)t===l[a]&&(n=!0);n?(o.$setValidity("termsAndConditions",e.p2pRegistration.userAgrees),u(),o.$setValidity("p2pAccountRequired",!1)):(o.$setValidity("termsAndConditions",!0),o.$setValidity("validEmailRequired",!0),o.$setValidity("p2pAccountRequired",!0))};c()}}},exports.p2pEnrollment.$inject=["$templateCache","transferTypes"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=window.jQuery,a=t(8),r=a.inject("lpUIUtils",t(11).name);exports.usAccountInput=function(e,t,a,i){return e.put("$usTransferCountryDropdownOption.html",'<span aria-label="{{option.country_name}}">{{option.country_code}}<span class="country-name"> - {{option.country_name}}</span></span>'),e.put("$usAccountInputTemplate.html",'<div class="lp-us-account-input"><div ng-class="{\'has-success\': isRoutingNoValid && routingNumber.length > 0, \'has-error\': !isRoutingNoValid && routingNumber.length, \'has-feedback\': routingNumber.length}"><input type="input" class="form-control routing-number" ng-model="routingNumber" lp-number-input="lp-number-input" min="0" maxlength="9" placeholder="{{\'Routing Number\'|translate}}" aria-required="true" aria-label="{{\'Routing Number\'|translate}}" /><span ng-if="isRoutingNoValid && routingNumber.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="resetRoutingNumber()" ng-if="!isRoutingNoValid && routingNumber.length" class="glyphicon glyphicon-remove form-control-feedback clickable-icon"></span></div><div class="lp-acc-plus-country"><div class="country-select" ng-if="showCountryDropdown"><div dropdown-select="dropdown-select" class="country-select" empty-placeholder-text="US" ng-model="selectedCountry" options="country.country_code as country for country in lpCountryList.countries" option-template-url="$usTransferCountryDropdownOption.html"></div></div><div ng-class="{\'has-success\': isAccNoConfirmed && accountNumber.length > 0, \'has-warning\': !isAccNoConfirmed && accountNumber.length, \'has-feedback\': accountNumber.length, \'account-number\': true}"><input type="input" class="form-control" ng-model="accountNumber" lp-number-input="lp-number-input" maxlength="19" min="0" placeholder="{{\'Account Number\'|translate}}" aria-required="true" aria-label="{{\'Account Number\'|translate}}"ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)"lp-input-overflow="lp-input-overflow" lp-format-us-account="lp-format-us-account"/><span ng-if="isAccNoConfirmed && accountNumber.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="confirmAccountNumber()" ng-keydown="confirmKeydown($event)" tabindex="{{!isAccNoConfirmed && accountNumber.length ? 0 : -1}}" ng-if="!isAccNoConfirmed && accountNumber.length" class="glyphicon glyphicon-warning-sign form-control-feedback clickable-icon" aria-label="Confirm Account Number" role="button"></span><div class="lp-input-dividers clearfix" style="top: 28px;"><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div></div></div></div><span class="lp-routing-info text-muted"><span lp-i18n="Where to find your account number & routing number"></span><i class="lp-icon lp-icon-xxl lp-icon-info-sign open-popup" ng-click="modal()"></i></span></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{account:"=ngModel",lpCountryList:"=",modal:"=",transferType:"=lpTransferType"},template:e.get("$usAccountInputTemplate.html"),link:function(e,o,s,l){var c=function(){e.isAccNoConfirmed=!1,e.isRoutingNoValid=!1,e.showCountryDropdown=!!e.lpCountryList,e.showCountryDropdown&&e.lpCountryList.default_country&&(e.selectedCountry=e.lpCountryList.default_country.country_code),w(e.transferType||"")},u=l[0],d=l[1];u.$name=s.name,d.$addControl(u),u.$setValidity("accountNumberRequired",!1),u.$setValidity("routingNumberRequired",!1);var p=o.find("input")[1],f=[],m=!1,h=0,v=i.bank,y=n(document.createElement("span"));y.addClass("lp-input-cursor-position-offset"),y.css("font-size",o.css("font-size")),n(p).after(y),u.$formatters.push(function(t){if(t)if(isNaN(parseInt(t.substring(0,2),10)))e.accountNumber="",e.routingNumber="";else{var n=t.split(" ");e.routingNumber=n[0],e.accountNumber=a("addSeperator")(n[1]),g(e.routingNumber),T(e.accountNumber)}else e.accountNumber="",e.routingNumber="";return t}),u.$parsers.push(function(e){var t=e.split(" ");return g(t[0]),T(t[1]),e}),e.confirmAccountNumber=function(){e.isAccNoConfirmed=!0,u.$setValidity("accountNumberConfirmed",!0)},e.confirmKeydown=function(t){13===t.which&&(t.stopPropagation(),t.preventDefault(),e.confirmAccountNumber(),o.find(".routing-number").focus())},e.resetRoutingNumber=function(){e.routingNumber=""},e.getSelection=function(e){var t=function(e){var t=0;return t+=parseInt(e/5,10),e-t};f=r.getSelectionPositionOfInput(p,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&p.value.length&&(m=!0)},e.setCursorPosition=function(){var n=r.getNewCaretPosition(p,f,h,m);if(m=!1,n>4){var a=n/4;parseInt(a,10)===a&&n--,n+=parseInt(a,10)}t(function(){r.setCaretPositionOfInput(p,n,e.paymentReference,y)},20,!1)},e.$watch("accountNumber",function(t,n){t!==n&&(e.isAccNoConfirmed=!1,E(),e.setCursorPosition())}),e.$watch("routingNumber",function(e,t){e!==t&&E()}),e.$watch("transferType",function(e,t){e!==t&&w(e)}),e.$on("reset",function(){e.routingNumber="",e.accountNumber=""});var g=function(t){if(t.length<9)return e.isRoutingNoValid=!1,void b(t);var n;if("000000000"===t)n=!1;else{var a=parseInt(t[0],10)+parseInt(t[3],10)+parseInt(t[6],10),r=parseInt(t[1],10)+parseInt(t[4],10)+parseInt(t[7],10),i=parseInt(t[2],10)+parseInt(t[5],10)+parseInt(t[8],10),o=3*a+7*r+i;n=o%10,n=0===n}e.isRoutingNoValid=n,b(t)},b=function(t){var n=t.length>0,a=!(n&&!e.isRoutingNoValid);u.$setValidity("routingNumberRequired",n),u.$setValidity("invalidRoutingNumber",a)},T=function(t){var n=!!(t&&t.length>0),a=!(t&&t.length>0&&!e.isAccNoConfirmed);u.$setValidity("accountNumberRequired",n),u.$setValidity("accountNumberConfirmed",a)},O=function(e){return e&&(e=e.replace(/ /g,"")),e||""},E=function(){var t=O(e.routingNumber)+" "+O(e.accountNumber);u.$setViewValue(t)},w=function(t){t!==v?(u.$setValidity("accountNumberRequired",!0),u.$setValidity("accountNumberConfirmed",!0),u.$setValidity("routingNumberRequired",!0),u.$setValidity("invalidRoutingNumber",!0)):(g(e.routingNumber||""),T(e.accountNumber||""))};c()}}},exports.usAccountInput.$inject=["$templateCache","$timeout","$filter","transferTypes"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.transferTypes={bank:"INTERNAL",p2pEmail:"P2P_EMAIL",p2pAddress:"P2P_ADDRESS",p2pMobile:"P2P_MOBILE"},exports.pendingPaymentOrdersTimeout=1e4,exports.customerId="3",exports.currencyMaxLength=15}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.lpPayments=function(){this.$get=function(e,t,n){function a(){var a=t(r.paymentsEndpoint,{},{getUnsubmitted:{method:"GET",url:r.paymentsEndpoint+"/:ids/unsubmitted",isArray:!0},create:{method:"PUT"},del:{method:"DELETE",url:r.paymentsEndpoint+"/:paymentId"},submit:{method:"POST",url:r.paymentsEndpoint+"/:paymentId/submit"}});return a.prototype.createOrder=function(t){var n=e.defer();return a.create({paymentId:t.id},t,function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise},a.prototype.send=function(t,n){var r=e.defer();return a.submit(t,n||{},function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},a.prototype.remove=function(t){var n=e.defer();return a.del({paymentId:t},{},function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise},a.prototype.createModel=function(){return new a({id:n.generateUUID()})},a.prototype.load=function(e){var t={f:0,l:100,ids:e.join()};return a.getUnsubmitted(t).$promise.then(function(e){return this.pendingOrdersGroups=this.preprocessPendingOrdersGroups(e),this.pendingOrdersGroups}.bind(this))},a.prototype.preprocessPendingOrdersGroups=function(e){for(var t,n=[],a=function(e){for(var t=!1,a=0;a<n.length;a++)n[a]["@id"]===e&&(t=!0);return t},r=function(e){n.push({"@id":e,paymentOrders:[]})},i=function(e){a(e.accountId)||r(e.accountId);for(var t=0;t<n.length;t++)n[t]["@id"]===e.accountId&&n[t].paymentOrders.push(e)},o=0;o<e.length;o++)t=e[o],t.counterpartyIban&&t.counterpartyIban.length>0?t.accountDetails=t.counterpartyIban:t.counterpartyAccount&&t.counterpartyAccount.length>0?t.accountDetails=t.counterpartyAccount:t.counterpartyEmail&&t.counterpartyEmail.length>0&&(t.accountDetails=t.counterpartyEmail),i(t);return n},a.prototype.makeFormObject=function(e){var t={update:!0,uuid:e.id,accountId:e.accountId,isScheduledTransfer:!!e.scheduledTransfer.every,scheduleDate:e.onDate?new Date(e.onDate):new Date,scheduledTransfer:{frequency:e.scheduledTransfer.frequency,every:e.scheduledTransfer.every,intervals:e.scheduledTransfer.intervals?[e.schedule.intervals]:[],timesToRepeat:e.scheduledTransfer.timesToRepeat||1,customOrder:e.scheduledTransfer.customOrder||!0,startDate:e.scheduledTransfer.startDate?new Date(e.scheduledTransfer.startDate):new Date},selectedCounter:{name:e.counterpartyName,account:e.counterpartyIban||e.counterpartyEmail},instructedCurrency:e.instructedCurrency,counterpartyName:e.counterpartyName,counterpartyAccount:e.counterpartyAccount,counterpartyIban:e.counterpartyIban||"",counterpartyEmail:e.counterpartyEmail,instructedAmount:e.instructedAmount.toFixed(2),paymentReference:e.paymentReference||"",paymentDescription:e.paymentDescription||"",counterpartyAddress:e.counterpartyAddress||"",isOpenDate:e.isOpenDate||!1,urgentTransfer:e.urgentTransfer||!1,type:e.type};return t},new a}var r={paymentsEndpoint:"/mock/v1/payments"};return{setConfig:function(e){return r=n(e).chain().mapValues(n.resolvePortalPlaceholders).defaults(r).value(),this},getConfig:function(e){return e&&n.isString(e)?r[e]:r},api:a}},this.$get.$inject=["$q","$resource","lpCoreUtils"]},exports.PaymentOrderModel=exports.lpPayments}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";function t(e){var t={"payment-orders":e};return{api:function(e){if("undefined"==typeof t[e])throw new Error("Unknown service "+e+" !!!");return t[e]}}}t.$inject=["PaymentOrders"],exports.lpAccountTransfers=function(){this.$get=t}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";function n(e,t){this.xhr=e,this.config={}}n.$inject=["$http","lpCoreError"];var a=t(8).utils,r={},i={url:"/mock/v2/payment-orders"};r.createModel=function(){return{}},r.createOrder=function(e){return this.xhr({method:"POST",url:this.config.url,data:e})},r.send=function(e,t){var n=this.config.url+"/"+e+"/submit";return this.xhr({method:"POST",url:n,data:t||{}})},r.remove=function(e){var t=this.config.url+"/"+e;return this.xhr({method:"DELETE",url:t})},r.selectOtpChannel=function(e){if(!e)throw Error("No URL for channel selectOtpChannel specified!");return this.xhr({method:"POST",url:e})},r.verifyOtp=function(e,t){if(!e)throw Error("No URL for verifyOtp specified!");if(!t||!t.otpCode)throw Error("No OTP code for verifyOtp specified!");return this.xhr({method:"POST",url:e,data:t}).then(function(e){return e.valid=!0,e},function(e){return e})},r.setConfig=function(e){return this.config=a.chain(e).mapValues(a.resolvePortalPlaceholders).defaults(i).value(),this},r.getConfig=function(e,t){return e&&a.isString(e)?this.config[e]||t:this.config},a.assign(n.prototype,r),exports.PaymentOrders=n}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}])});
//# sourceMappingURL=main.js.map