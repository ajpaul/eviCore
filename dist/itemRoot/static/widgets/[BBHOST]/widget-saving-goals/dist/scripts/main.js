/* Build with bb-lp-cli @ v1.7.1 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("core"),require("ui")):"function"==typeof define&&define.amd?define(["base","core","ui"],t):"object"==typeof exports?exports["widget-saving-goals"]=t(require("base"),require("core"),require("ui")):e["widget-saving-goals"]=t(e.base,e.core,e.ui)}(this,function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,exports,t){var n;(function(e){n=function(require,exports,e){"use strict";function n(e,t){t.publish("cxp.item.loaded",{id:e.model.name})}e.name="widgets-saving-goals";var i=t(2),a=t(3),o=t(4),r=[a.name,o.name];n.$inject=["lpWidget","lpCoreBus"],e.exports=i.createModule(e.name,r).factory(t(5)).controller(t(6)).directive(t(7)).directive(t(8)).directive(t(9)).run(n)}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(1)(e))},function(e,exports){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(t,exports){t.exports=e},function(e,exports){e.exports=t},function(e,exports){e.exports=n},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.state=function(){return{view:"list",accountList:[],savingGoals:[],editorSavingGoal:{}}},exports.SavingAccounts=function(e,t,n){var i=n.resolvePortalPlaceholders(t.getPreference("savingAccountsDataSrc"));return e(i,{})},exports.SavingAccounts.$inject=["$resource","lpWidget","lpCoreUtils"],exports.SavingGoal=function(e,t,n){var i=n.resolvePortalPlaceholders(t.getPreference("savingGoalsDataSrc")),a={"Content-Type":"application/json"};return e(i,{savingId:"@savingId"},{query:{method:"GET",isArray:!0},save:{method:"POST",headers:a},update:{method:"PUT",headers:a}})},exports.SavingGoal.$inject=["$resource","lpWidget","lpCoreUtils"],exports.SavingGoalService=function(e,t,n,i){var a=function(e){return{AHEAD_OF_PLAN:"success",ON_TRACK:"success",OVERDUE:"warning"}[e]},o=function(e){return e.saved=e.saved||0,e.type=a(e.status),e.percentageSaved=e.amount?Math.round(100*e.saved/e.amount):0,e.targetDate=i.date(e.targetDate).toDate(),e};return{getAll:function(){var t=e.defer();return n.query({},function(e){var n=i.transform(e,function(e,t){e.push(o(t))});t.resolve(n)},function(e){t.reject("Could not load saving goals")}),t.promise},create:function(t){var a=e.defer(),r=new n(t);return i.assign(r,{targetDate:r.targetDate.toISOString()}),r.$save(function(e){i.assign(r,{id:e.id}),a.resolve(o(r))},function(e){a.reject("Could not create Saving Goal")}),a.promise},update:function(t){var i=e.defer();return n.update({savingId:t.id},t,function(e){i.resolve(o(t))}),i.promise},remove:function(t){var i=e.defer();return n.remove({savingId:t},function(e){i.resolve(!0)}),i.promise}}},exports.SavingGoalService.$inject=["$q","$timeout","SavingGoal","lpCoreUtils"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";function n(){var e=["car","college","computer","house","payoffloan","pension","phone","rainyday","trip"];return r.transform(e,function(e,t){e[t]="icon-icons-goals_"+t},{})}function i(e,t){var n=new Date(e),i=(new Date).setMonth(n.getMonth()+t);return new Date(i)}function a(e,t){r.isArray(e)||(e=[e]),r.forEach(e,function(e){var n=r.findWhere(t,{id:e.accountId});n&&(e.currency=n.currency)})}var o=t(2),r=o.utils,s=o.ng;exports.SavingGoalAppCtrl=function(e){var t=this;t.state=e},exports.SavingGoalAppCtrl.$inject=["state"],exports.SavingGoalListCtrl=function(e,t,i,o){var r=this;r.state=t,r.iconMap=n();var s=function(){return i.query(function(e){return r.state.accountList=e,e})},c=function(){return r.loading=!0,r.error=!1,o.getAll().then(function(e){return r.state.savingGoals=r.state.savingGoals.concat(e),r.state.savingGoals},function(e){r.error=!0})["finally"](function(){r.loading=!1})};r.addSavingGoal=function(){window.scroll(0,0),r.state.view="editor:create",r.state.editorSavingGoal={}},r.updateSavingGoal=function(e){window.scroll(0,0),r.state.view="editor:update",r.state.editorSavingGoal=e},r.initializeSavingGoalsList=function(){e.all({accounts:s(),goals:c()}).then(function(e){a(e.goals,e.accounts)})},r.initializeSavingGoalsList()},exports.SavingGoalListCtrl.$inject=["$q","state","SavingAccounts","SavingGoalService"],exports.SavingGoalEditorCtrl=function(e,t,o,c){var l=this;l.state=t,l.loading=!1,l.iconMap=n(),l.showAccountSelect=o.getPreference("showAccountSelect"),l.isRemoving=!1,l.removeConfirm=!1;var u=parseInt(o.getPreference("minMonths"),10)||1,v=i(new Date,u);l.showTargetDateCalendar=!1,e.$watch(function(){return l.state.editorSavingGoal},function(e,t){l.savingGoal=s.copy(e),"editor:create"===l.state.view?(l.minTargetDate=v,l.savingGoal.targetDate=l.minTargetDate):(l.savingGoal.targetDate=new Date(l.savingGoal.targetDate),l.minTargetDate=l.savingGoal.targetDate)}),l.create=function(t){return e.goalForm.title.$setValidity("duplicate",!r.isObject(r.find(l.state.savingGoals,function(e){return e.title===t.title}))),e.goalForm.$invalid?void e.goalForm.$setDirty():(l.loading=!0,void c.create(t).then(function(e){l.loading=!1,l.state.savingGoals.push(e),a(e,l.state.accountList),l.state.view="list"},function(e){l.loading=!1}))},l.update=function(t){c.update(t).then(function(e){s.copy(l.savingGoal,l.state.editorSavingGoal),a(e,l.state.accountList)}),e.goalForm.$setPristine(),l.state.view="list"},l.remove=function(t){l.isRemoving=!0,c.remove(t).then(function(){l.hideConfirm(),l.state.savingGoals=r.without(l.state.savingGoals,l.state.editorSavingGoal),l.state.view="list"})["finally"](function(){l.isRemoving=!1}),e.goalForm.$setPristine()},l.cancel=function(){e.goalForm.$setPristine(),l.state.view="list"},l.openCalendar=function(e){e.preventDefault(),e.stopPropagation(),l.showTargetDateCalendar=!0},l.showConfirm=function(){l.removeConfirm=!0},l.hideConfirm=function(){l.removeConfirm=!1}},exports.SavingGoalEditorCtrl.$inject=["$scope","state","lpWidget","SavingGoalService"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.iconSelect=function(e,t){function n(e,t,n,i){e.selectIcon=function(t){e.ngModel=t}}function i(){return['<div class="icon-select">','<div class="icon-list" tabindex="3">','<div class="icon {{ value }}"','   ng-class="{selected: ngModel == name}"','   ng-click="selectIcon(name)"','   ng-repeat="(name, value) in icons">',"</div>","</div>","</div>"].join("")}return{scope:{icons:"=",ngModel:"="},restrict:"EA",template:i,replace:!0,link:n}},exports.iconSelect.$inject=["lpWidget","lpCoreUtils"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.maxlength=function(){return{scope:{},restrict:"A",link:function(e,t,n){t.on("input",function(){var e=this.maxLength;this.value.length>e&&(this.value=this.value.substr(0,e))})}}}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";exports.greaterThanZero=function(){return{require:"ngModel",link:function(e,t,n,i){i.$parsers.unshift(function(e){var t=parseFloat(e.replace(",","."));return parseFloat(t)>0?(i.$setValidity("GreaterThanZero",!0),t):void i.$setValidity("GreaterThanZero",!1)})}}}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}])});
//# sourceMappingURL=main.js.map