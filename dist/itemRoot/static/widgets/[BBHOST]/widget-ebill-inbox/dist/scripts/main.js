/* Build with bb-lp-cli @ v1.8.1 */
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("base"),require("core"),require("ui"),require("module-ebilling")):"function"==typeof define&&define.amd?define(["base","core","ui","module-ebilling"],n):"object"==typeof exports?exports["widget-ebill-inbox"]=n(require("base"),require("core"),require("ui"),require("module-ebilling")):e["widget-ebill-inbox"]=n(e.base,e.core,e.ui,e["module-ebilling"])}(this,function(e,n,t,i){return function(e){function n(i){if(t[i])return t[i].exports;var o=t[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,exports,n){var t;(function(e){t=function(require,exports,e){"use strict";e.name="widget-ebill-inbox";var t=n(2),i=n(3),o=n(4),c=n(5),l=[i.name,o.name,c.name],s=function(e,n,t,i){var o={debitOrdersSrc:e.getPreference("debitOrdersSrc"),mandatesSrc:e.getPreference("mandatesSrc"),accountsEndPoint:e.getPreference("accountsDataSrc"),baseUrl:t.getWidgetBaseUrl(e)};n.setConfig(o),e&&e.model&&e.model.name&&i.publish("cxp.item.loaded",{id:e.model.name})};s.$inject=["lpWidget","lpEbilling","lpCoreUtils","lpCoreBus"],e.exports=t.createModule(e.name,l).controller(n(6)).run(s)}.call(exports,n,exports,e),!(void 0!==t&&(e.exports=t))}).call(exports,n(1)(e))},function(e,exports){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(n,exports){n.exports=e},function(e,exports){e.exports=n},function(e,exports){e.exports=t},function(e,exports){e.exports=i},function(e,exports,n){var t;t=function(require,exports,e){"use strict";exports.MainCtrl=function(e,n){var t=e.getConfig();this.isTouch=n.isTouch,this.baseUrl=t.baseUrl},exports.MainCtrl.$inject=["lpEbilling","lpEbillingUtils"],exports.DetailsCtrl=function(e,n){var t=this;t.init=function(e){e.processing=!0,e.mandate.$get().then(function(e){t.mandate=e},function(e){t.response="Unable to fetch e-bill."})["finally"](function(){e.processing=!1})},n.$on("$destroy",function(){t.mandate=null})},exports.DetailsCtrl.$inject=["lpEbilling","$scope"],exports.PaymentCtrl=function(e,n,t,i){var o=this;o.paymentParams={},o.init=function(n){o.bill=n,o.minDate=new Date,o.paymentParams.scheduleDate=n.scheduleDate&&new Date(n.scheduleDate),e.getAccounts().then(function(e){o.accounts=e,o.paymentParams.account=e.filter(function(e){return e.identifier===n.mandate.debtor.account})[0]})},i(function(){o.paymentParams.amount=o.bill.amount}),t.$watch("payCtrl.specificAmount",function(e){o.paymentParams.amount=e}),t.$on("$destroy",function(){})},exports.PaymentCtrl.$inject=["lpEbilling","lpEbillingUtils","$scope","$timeout"],exports.BillsListCtrl=function(e,n,t,i,o,c,l,s){var r=i,u=this,a={f:0,l:4,sort:"+paymentDueDate"};u.hasMore=!1;var f=function(e){"number"==typeof e&&(u.hasMore=e>=a.l)},d=function(n){var i=l.defer();return t.isUndefined(n.scheduledDate)?n.scheduledDate=null:n.scheduledDate=n.scheduledDate instanceof Date?new Date(n.scheduledDate).getTime():null,t.isObject(n.accountId)?(n.accountId=n.accountId.id,i.resolve(n)):e.getAccounts().then(function(e){n.accountId=e.filter(function(e){return e.identifier===n.accountId})[0].id||null,i.resolve(n)}),i.promise};u.init=function(){u.fetch()},u.sync=function(){u.fetch(),r.publish("lp.widget.e-bill-inbox:sync",{},!0)},u.loadMore=function(){a.f=u.bills.length,n.getAll(a).then(function(e){f(e.length),e.length>0&&(u.bills=u.bills.concat(e),u.groups=t.groupBy(u.bills,"dueDate","Due","overdue"))})},u.fetch=function(){u.loading=!0,u.bills=[];var e=n.getAll(a),i=n.getAllNew();l.all([e,i]).then(function(e){var n=e[0],i=e[1];f(n.length),n.length||i.length?(u.bills=u.bills.concat(n),u.newBills=i,u.groups=t.groupBy(u.bills,"dueDate","Due","overdue")):u.response="No results"},function(e){u.response="Unable to fetch data"})["finally"](function(){u.loading=!1})},u.confirm=function(e){},u.decline=function(e,n){e.opened=!1,e.processing=!0,e.actions.decline({id:e.id},null).$promise.then(function(n){e.response={},e.response.message="Bill declined",c(function(){u.sync()},1e3)},function(e){t.error(e)})["finally"](function(){t.info("Done"),e.processing=!1})},u.accept=function(e,n){e.opened=!1,e.processing=!0,e.actions.accept({id:e.id},null).$promise.then(function(n){e.response={},e.response.action="success",e.response.message="Bill accepted",c(function(){u.sync()},1e3)},function(e){t.error(e)})["finally"](function(){t.info("Done"),e.processing=!1})},u.pay=function(e,n,i,o){n={accountId:n.account||e.mandate.debtor.account,amount:n.amount||e.amount,scheduledDate:n.scheduleDate||e.scheduleDate},e.opened=!1,e.processing=!0,d(n).then(function(n){e.actions.pay({id:e.id},n).$promise.then(function(n){e.response={},e.response.action="success",e.response.message="Payment succesfull",c(function(){u.sync()},8e3)},function(e){t.error(e)})["finally"](function(){t.info("Done"),e.processing=!1})})},u.reject=function(e,n,i){e.opened=!1,e.processing=!0,e.actions.reject({id:e.id},null).$promise.then(function(n){e.response={},e.response.message="Bill declined",c(function(){u.sync()},1e3)},function(e){t.error(e)})["finally"](function(){e.processing=!1})}},exports.BillsListCtrl.$inject=["lpEbilling","lpEbillingDebitOrdersModel","lpEbillingUtils","lpEbillingBus","$scope","$timeout","$q","$cacheFactory"]}.call(exports,n,exports,e),!(void 0!==t&&(e.exports=t))}])});
//# sourceMappingURL=main.js.map