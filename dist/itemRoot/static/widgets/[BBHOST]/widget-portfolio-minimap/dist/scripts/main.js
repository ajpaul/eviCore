/* widget-portfolio-minimap@v2.3.2 build with â™¥ by bb-lp-cli@v1.9.17 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("ui"),require("module-charts"),require("module-wealth"),require("d3")):"function"==typeof define&&define.amd?define(["base","ui","module-charts","module-wealth","d3"],t):"object"==typeof exports?exports["widget-portfolio-minimap"]=t(require("base"),require("ui"),require("module-charts"),require("module-wealth"),require("d3")):e["widget-portfolio-minimap"]=t(e.base,e.ui,e["module-charts"],e["module-wealth"],e.d3)}(this,function(e,t,n,r,o){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="/",t(0)}([function(e,exports,t){e.exports=t(1)},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){function n(e,t){t.setConfig({portfolioEndPoint:e.getPreference("dataSrc")})}n.$inject=["lpWidget","lpWealth"],e.name="widget-portfolio-minimap";var r=t(3),o=t(4),a=t(5),i=t(6),u=[o.name,a.name,i.name];e.exports=r.createModule(e.name,u).controller(t(7)).directive(t(8)).run(n)}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(2)(e))},function(e,exports){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(t,exports){t.exports=e},function(e,exports){e.exports=t},function(e,exports){e.exports=n},function(e,exports){e.exports=r},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var t=31556952e3,n=[{name:"10 years",value:10*t},{name:"5 years",value:5*t},{name:"3 years",value:3*t},{name:"1 year",value:t},{name:"9 months",value:.75*t},{name:"6 months",value:t/2},{name:"3 months",value:t/4},{name:"1 month",value:t/12}],r={monthly:"Monthly",yearly:"Yearly"};exports.MainCtrl=function(e,t,o){function a(e){var t=e[l.frequency],r=t[t.length-1].date-t[0].date;return u.spans=n.filter(function(e){return e.value<r}),e}function i(e){u.loading=!1,u.data=e}var u=this,l=u.config={timespan:o.getConfig("timespan"),frequency:o.getConfig("frequency")};u.freqs=r,u.spans=n,u.setFreq=function(e){l.frequency=e,t.publish("portfolio-frequency",e)},u.setSpan=function(e){l.timespan=e},t.subscribe("launchpad-retail.portfolioSelected",function(t){u.loading=!0,e.getData(t.id).then(a).then(i)})},exports.MainCtrl.$inject=["ptfModel","lpCoreBus","lpWealth"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";function n(e,t){var n=new Date(e);return t.indexOf("year")===-1?n.setMonth(e.getMonth()-parseInt(t,10)):n.setFullYear(e.getFullYear()-parseInt(t,10)),[n,e]}var r=t(9),o=t(3).ng,a=r.time.format.multi([["%Y",function(e){return 0===e.getMonth()}],["%b",function(e){return 1===e.getDate()}],["",function(){return!0}]]),i=-20;exports.lpWealthMinimap=function(e,t,u,l,c,s,f){function d(l,d){function g(e){return function(){p.publish(e,k.range())}}function y(e,t){return!(!e||!e[t]||e[t].length<2)}function v(e,t){if(y(l.data,w.frequency)){var r=n(e[1],t),o=P.domain();r[0]<o[0]&&(r[0]=o[0]),k.range(r).render(),b()}}function x(){var e=l.data;y(e,w.frequency)&&(e=e[w.frequency],S.data=e,P.domain(r.extent(e,m)),C.domain(r.extent(e,h)),W.render(),j.render(),v(P.domain(),w.timespan))}function q(){var e=d.innerWidth(),t=d.innerHeight();e<=0||t<=0||(P.range([0,e]),C.range([t,0]),$.attr({width:e,height:t}),W.resize(e,t),j.resize(e,t),k.resize(e,t),x())}var b,w=l.config,M=d.find("svg")[0],$=r.select(M),P=r.time.scale(),C=r.scale.linear(),S={node:$,xScale:P,yScale:C,parsers:{x:m,y:h},formatters:{x:a}},W=c(S).attr("class","area"),j=s(S).ticks({y:0});j.x.tickPadding(i);var k=f(S);b=g("portfolio-rangeSelected"),k.on("brush",g("portfolio-rangeSelected-live")).on("brushend",b),q(),u.sticky(d,50),u.onParentPanelToggle(d,q),l.$watch("data",x),l.$watch("config.timespan",function(e){v(k.range(),e)}),l.$watch("config.frequency",q),l.$on("$destroy",function(){}),o.element(e).on("resize",t.debounce(q,250))}var p=l,m=t.property("date"),h=function(e){return e.datapoint.totalPortfolioValue};return{restrict:"EA",require:"?ngModel",priority:Number.MAX_VALUE,link:d,template:"<svg/>",scope:{data:"=ngModel",config:"=lpWealthMinimap",onRender:"&onRender"}}},exports.lpWealthMinimap.$inject=["$window","utils","wealthUtils","lpCoreBus","areaFactory","axesFactory","brushFactory"]}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports){e.exports=o}])});
//# sourceMappingURL=main.js.map