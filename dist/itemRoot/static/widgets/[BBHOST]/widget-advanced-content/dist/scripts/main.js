/* widget-advanced-content@v1.0.0 build with â™¥ by bb-lp-cli@v1.9.13 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("jquery")):"function"==typeof define&&define.amd?define(["base","jquery"],t):"object"==typeof exports?exports["widget-advanced-content"]=t(require("base"),require("jquery")):e["widget-advanced-content"]=t(e.base,e.jquery)}(this,function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,exports,t){e.exports=t(1)},function(e,exports,t){var n;(function(e){"use strict";n=function(require,exports,e){e.name="widget-advanced-content";var n=t(3).bus,i=t(4),o=t(9),r=t(5);i.registerConstructor(o).registerConstructor(r),e.exports=function(e){return n.publish("cxp.item.loaded",{id:e.model.name}),i.setup(e).init()}}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}).call(exports,t(2)(e))},function(e,exports){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(t,exports){t.exports=e},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=[],i=t(5),o={widget:null,templateUrl:null,setup:function(e){return this.widget=e,this.templateUrl=e.model.getPreference("templateUrl"),this},registerConstructor:function(e){return n.push(e),this},init:function(){var e=null,t="Constructor has been found";try{n.forEach(function(n){if("function"==typeof n.isSameType&&n.isSameType(o.templateUrl))throw e=n,new Error(t)})}catch(r){if(r.message!==t)return console.log("Something went wrong during the initialization")}return e=e||i,(new e).setup(this.widget).init()}};e.exports=o}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";function n(e){return e.find(".lp-background-image:first img").prop("src")}function i(e){var t=e.widget,n=e.$widget,i=(t.getPreference("bgImageContainer"),n.find(d.bgImage)),o=t.getPreference("bgImageContainer"),r=c[o](t),a=t.getPreference("bgImageSize"),s=t.getPreference("bgImageScroll");0!==i.length&&i&&r&&r.css({"background-image":"url("+i.attr("src")+")","background-size":a,"background-position":"center top","background-repeat":"no-repeat","background-attachment":s})}var o=t(6),r=t(7),a=t(8),s=r.prototype,d={bgImage:".bg-image",bpWidget:".bp-widget"},c={widget:function(e){return o(e.body).closest(d.bpWidget)},fullscreen:function(){return o("#main")}},l=function(){r.call(this)};l.prototype=new r,l.prototype.setHeight=function(){var e=this.widget.getPreference("height");e&&this.$widget.height(e)},l.prototype.setBackground=function(){s.fixEditing(this.$widget),i({widget:this.widget,$widget:this.$widget})},l.prototype.init=function(){var e=this;s.init.call(this).then(function(){function t(){e.setBackground(),"launchpad:show"===o(e.widget.htmlNode).attr("data-event")&&o(e.widget.htmlNode).removeAttr("data-event")}if(e.DraggableICEBehavior=new a(e.widget,{}),e.DraggableICEBehavior.init(bd.designMode),e.setHeight(),e.$widget.is(":visible")&&e.setBackground(),e.widget.model.addEventListener("PrefModified",function(t){"widgetContentsUpdated"===t.attrName&&(e.setHeight(),e.setBackground())}),o(e.widget.htmlNode).on("launchpad:show",function(){t()}),"launchpad:show"===o(e.widget.htmlNode).attr("data-event")&&t(),bd.designMode){for(var i,r=e.widget;r.parentNode;){if(r=r.parentNode,"TCont"===r.nodeName){var s=r;break}i=r}s&&o(s.htmlNode).find(".bp-tContFn-tab").on("click",function(t){var r=s.childNodes.indexOf(i),a=o(t.currentTarget).index();a=(a+1)%s.childNodes.length,r===a&&n(o(i.htmlNode))===n(e.$widget)&&e.setBackground()}),e.widget.addEventListener("preferences-form",function(){for(var t=b$.portal.portalModel.filterPreferences(e.widget.model.preferences.array),n=0;n<t.length;n++){var i=t[n];if("templateUrl"===i.name){for(var o=e.widget.getPreference("templateList"),r=o.split(","),a=0,s=0;a<r.length;a++,s++)t[n].inputType.options[s]={label:r[a],value:r[a+1]},a++;break}}})}})},e.exports=l}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports){e.exports=t},function(e,exports,t){var n;n=function(require,exports,e){var n=t(6),i={notEditable:"[contenteditable=false]:not(img)",lpIce:".lp-ice",focusLpIce:"focus.lp-ice",brokenImages:'img[src=""], img:not([src])',hideBrokenImages:"be-ice-hide-image",gInclude:".bp-g-include"},o=function(){var e,t,i=window.CKEDITOR;if(i&&i.instances)for(e in i.instances)if(t=i.instances[e],this===t.element.$)return t.destroy(),n(this).attr("contenteditable",!0),void i.inline(this)},r=function(e){e.off(i.lpIce).on(i.focusLpIce,i.notEditable,function(){e.find(i.notEditable).each(o)})},a=function(e){var t=e.widget,n=e.$widget,o=e.templateUrl,r=e.fixEditing;return be.ice.controller.edit(t,o).then(function(e){return n.find(i.gInclude).html(e),r(n),e})},s=function(){this.widget=null,this.$widget=null};s.isSameType=function(e,t){return e.indexOf(t)>-1},s.prototype={setup:function(e){return this.widget=e,this.$widget=n(e.body),this.templateUrl=e.getPreference("templateUrl"),this},fixEditing:r,init:function(){var e,t,o=new n.Deferred,s=this.widget;return be.ice&&bd&&"true"===bd.designMode?(s.iceConfig=n.extend(!0,{},be.ice.config),s.iceConfig.events.push("lp-drag"),e=top&&top.bd&&top.bd.PageMgmtTree&&top.bd.PageMgmtTree.selectedLink&&top.bd.PageMgmtTree.selectedLink.isMasterPage,t=e||"true"===s.model.manageable||""===s.model.manageable||void 0===s.model.manageable,t&&be.ice.controller?o.resolve(a({widget:s,$widget:this.$widget,templateUrl:this.templateUrl,fixEditing:r})):o.resolve()):(n(i.brokenImages,this.$widget).addClass(i.hideBrokenImages),o.resolve()),o.promise()}},e.exports=s}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n,i=t(6),o=function(e,t){var n,o,r=i.extend({draggableAreaSelector:".lp-content-text-area",containersSelector:".lp-promo-slide",grippyContents:"Drag",draggableClass:"draggable",preferenceName:"content-position",defaultCoordinates:{top:"50px",left:"50px"}},t),a=i(e.body),s="lp-grippy",d=400,c=!0,l=function(e,t,n){n=i.extend({onStop:function(){},prevent:!0},n);var o,s=function d(){e.removeClass(r.draggableClass),e.parents().unbind("mousemove",o),i(document).unbind("mouseup",d),n.onStop(e)};t.on("mousedown",function(t){n.prevent&&(t.preventDefault(),t.stopPropagation()),e.addClass(r.draggableClass);var d=e.outerHeight(),c=e.outerWidth(),l=e.offset().top+d-t.pageY,u=e.offset().left+c-t.pageX;o=function(t){var n=t.pageY+l-d,i=t.pageX+u-c,o=a.offset().top,r=o+a.outerHeight(),s=a.offset().left,f=s+a.outerWidth();o>n||n>r-20||s>i||i>f-20||e.offset({top:n,left:i})},e.parents().on("mousemove",o),i(document).on("mouseup",s)})},u=function(t,n){o[t]={top:n.css("top"),left:n.css("left")},e.setPreference(r.preferenceName,JSON.stringify(o)),e.model.save()},f=function(e){var t=i("<div/>").text(r.grippyContents).addClass(s).appendTo(e);t.hover(function(){t.data("is:hover",!0)},function(){t.data("is:hover",!1)}),e.hover(function(){t.show(),t.data("timeout")&&clearTimeout(t.data("timeout"))},function(){var e=setTimeout(function(){t.data("is:hover")||t.hide()},500);t.data("timeout",e)}),l(e,t,{onStop:function(e){u(e.attr("id"),e)}})},p=function(){n=i(r.containersSelector,a),n.each(function(e,t){var n=i(t).find(r.draggableAreaSelector);c&&f(n),"absolute"!==n.css("position")&&n.css("position","absolute")})},g=function(){var e=n.find(r.draggableAreaSelector),t=o[n.attr("id")];"undefined"!==t&&t||(t={top:r.defaultCoordinates.top,left:r.defaultCoordinates.left}),e.css({top:t.top,left:t.left}),e.animate({opacity:1},d)},m=function(t){c=!!t,p();try{o=JSON.parse(e.getPreference(r.preferenceName))}catch(n){o=r.defaultCoordinates}g()},h=function(e){e=i(e),e.find("."+s).remove(),e.find(r.draggableAreaSelector).css({top:"",left:"",opacity:""})};return{init:m,cleanup:h}},r=be.ice&&be.ice&&be.ice.events;return r&&(r.registerEventListener("lp-drag",function(e,t){n=new o(t,{}),n.init(bd.designMode)}),r.registerEventCleaner("lp-drag",function(e){n.cleanup(e)})),e.exports=o,o}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))},function(e,exports,t){var n;n=function(require,exports,e){"use strict";var n=t(7),i=n.prototype,o={upClass:"lp-icon-caret-up",downClass:"lp-icon-caret-down",faqContent:".lp-faq-content",toggleClass:".lp-accordion-toggle-class",faqTitle:".lp-faq-title",collapsed:"collapsed"},r=function(){n.call(this)};r.isSameType=function(e){return n.isSameType(e,"accordion")},r.prototype=new n,r.prototype.init=function(){var e=this;i.init.call(this).then(function(){var t=e.$widget,n=o.upClass,i=o.downClass;$(o.faqTitle,t).click(function(e){var r=$(e.target),a=r.hasClass(o.collapsed),s={};s=a?{remove:i,add:n,action:"slideDown"}:{remove:n,add:i,action:"slideUp"},$(o.toggleClass).removeClass(s.remove).addClass(s.add),$(o.faqContent,t)[s.action](300),r.toggleClass(o.collapsed,!a)})})},e.exports=r}.call(exports,t,exports,e),!(void 0!==n&&(e.exports=n))}])});
//# sourceMappingURL=main.js.map